{"ast":null,"code":"function createCustomError(e) {\n  function n(e, n) {\n    Error.captureStackTrace && Error.captureStackTrace(this, this.constructor), this.message = e, this.code = n;\n  }\n\n  return n.prototype = new Error(), n.prototype.name = e, n.prototype.constructor = n, n;\n}\n\nvar LDUnexpectedResponseError = createCustomError(\"LaunchDarklyUnexpectedResponseError\"),\n    LDInvalidEnvironmentIdError = createCustomError(\"LaunchDarklyInvalidEnvironmentIdError\"),\n    LDInvalidUserError = createCustomError(\"LaunchDarklyInvalidUserError\"),\n    LDInvalidEventKeyError = createCustomError(\"LaunchDarklyInvalidEventKeyError\"),\n    LDInvalidArgumentError = createCustomError(\"LaunchDarklyInvalidArgumentError\"),\n    LDFlagFetchError = createCustomError(\"LaunchDarklyFlagFetchError\");\n\nfunction isHttpErrorRecoverable(e) {\n  return !(e >= 400 && e < 500) || 400 === e || 408 === e || 429 === e;\n}\n\nfor (var fromByteArray_1 = fromByteArray, lookup = [], revLookup = [], code = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\", i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i], revLookup[code.charCodeAt(i)] = i;\n}\n\nfunction tripletToBase64(e) {\n  return lookup[e >> 18 & 63] + lookup[e >> 12 & 63] + lookup[e >> 6 & 63] + lookup[63 & e];\n}\n\nfunction encodeChunk(e, n, t) {\n  for (var r, o = [], a = n; a < t; a += 3) {\n    r = (e[a] << 16 & 16711680) + (e[a + 1] << 8 & 65280) + (255 & e[a + 2]), o.push(tripletToBase64(r));\n  }\n\n  return o.join(\"\");\n}\n\nfunction fromByteArray(e) {\n  for (var n, t = e.length, r = t % 3, o = [], a = 0, i = t - r; a < i; a += 16383) {\n    o.push(encodeChunk(e, a, a + 16383 > i ? i : a + 16383));\n  }\n\n  return 1 === r ? (n = e[t - 1], o.push(lookup[n >> 2] + lookup[n << 4 & 63] + \"==\")) : 2 === r && (n = (e[t - 2] << 8) + e[t - 1], o.push(lookup[n >> 10] + lookup[n >> 4 & 63] + lookup[n << 2 & 63] + \"=\")), o.join(\"\");\n}\n\nrevLookup[\"-\".charCodeAt(0)] = 62, revLookup[\"_\".charCodeAt(0)] = 63;\n\nvar _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n  return typeof e;\n} : function (e) {\n  return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n},\n    fastDeepEqual = function e(n, t) {\n  if (n === t) return !0;\n  var r,\n      o = Array.isArray(n),\n      a = Array.isArray(t);\n\n  if (o && a) {\n    if (n.length != t.length) return !1;\n\n    for (r = 0; r < n.length; r++) {\n      if (!e(n[r], t[r])) return !1;\n    }\n\n    return !0;\n  }\n\n  if (o != a) return !1;\n\n  if (n && t && \"object\" === (void 0 === n ? \"undefined\" : _typeof(n)) && \"object\" === (void 0 === t ? \"undefined\" : _typeof(t))) {\n    var i = Object.keys(n);\n    if (i.length !== Object.keys(t).length) return !1;\n    var s = n instanceof Date,\n        u = t instanceof Date;\n    if (s && u) return n.getTime() == t.getTime();\n    if (s != u) return !1;\n    var c = n instanceof RegExp,\n        l = t instanceof RegExp;\n    if (c && l) return n.toString() == t.toString();\n    if (c != l) return !1;\n\n    for (r = 0; r < i.length; r++) {\n      if (!Object.prototype.hasOwnProperty.call(t, i[r])) return !1;\n    }\n\n    for (r = 0; r < i.length; r++) {\n      if (!e(n[i[r]], t[i[r]])) return !1;\n    }\n\n    return !0;\n  }\n\n  return !1;\n},\n    _extends = Object.assign || function (e) {\n  for (var n = 1; n < arguments.length; n++) {\n    var t = arguments[n];\n\n    for (var r in t) {\n      Object.prototype.hasOwnProperty.call(t, r) && (e[r] = t[r]);\n    }\n  }\n\n  return e;\n};\n\nfunction btoa(e) {\n  var n = unescape(encodeURIComponent(e));\n  return fromByteArray_1(stringToBytes(n));\n}\n\nfunction stringToBytes(e) {\n  for (var n = [], t = 0; t < e.length; t++) {\n    n.push(e.charCodeAt(t));\n  }\n\n  return n;\n}\n\nfunction base64URLEncode(e) {\n  return btoa(e).replace(/=/g, \"\").replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n}\n\nfunction clone(e) {\n  return JSON.parse(JSON.stringify(e));\n}\n\nfunction deepEquals(e, n) {\n  return fastDeepEqual(e, n);\n}\n\nfunction onNextTick(e) {\n  setTimeout(e, 0);\n}\n\nfunction wrapPromiseCallback(e, n) {\n  var t = e.then(function (e) {\n    return n && setTimeout(function () {\n      n(null, e);\n    }, 0), e;\n  }, function (e) {\n    if (!n) return Promise.reject(e);\n    setTimeout(function () {\n      n(e, null);\n    }, 0);\n  });\n  return n ? void 0 : t;\n}\n\nfunction transformValuesToVersionedValues(e) {\n  var n = {};\n\n  for (var t in e) {\n    e.hasOwnProperty(t) && (n[t] = {\n      value: e[t],\n      version: 0\n    });\n  }\n\n  return n;\n}\n\nfunction transformVersionedValuesToValues(e) {\n  var n = {};\n\n  for (var t in e) {\n    e.hasOwnProperty(t) && (n[t] = e[t].value);\n  }\n\n  return n;\n}\n\nfunction chunkUserEventsForUrl(e, n) {\n  for (var t = n.slice(0), r = [], o = e, a = void 0; t.length > 0;) {\n    for (a = []; o > 0;) {\n      var i = t.shift();\n      if (!i) break;\n      (o -= base64URLEncode(JSON.stringify(i)).length) < 0 && a.length > 0 ? t.unshift(i) : a.push(i);\n    }\n\n    o = e, r.push(a);\n  }\n\n  return r;\n}\n\nfunction getLDUserAgentString() {\n  return \"JSClient/2.8.0\";\n}\n\nfunction addLDHeaders(e) {\n  e.setRequestHeader(\"X-LaunchDarkly-User-Agent\", getLDUserAgentString());\n}\n\nfunction extend() {\n  for (var e = arguments.length, n = Array(e), t = 0; t < e; t++) {\n    n[t] = arguments[t];\n  }\n\n  return n.reduce(function (e, n) {\n    return _extends({}, e, n);\n  }, {});\n}\n\nvar MAX_URL_LENGTH = 2e3;\n\nfunction EventSender(e, n, t, r) {\n  var o = void 0,\n      a = e + \"/events/bulk/\" + n,\n      i = e + \"/a/\" + n + \".gif\",\n      s = {};\n\n  function u(e, n) {\n    var t = new window.Image();\n    n && t.addEventListener(\"load\", n), t.src = e;\n  }\n\n  function c(e, n, t) {\n    var o = r || u,\n        s = JSON.stringify(e),\n        c = function c(e) {\n      if (n) (function n(r) {\n        var o = new window.XMLHttpRequest();\n        return o.open(\"POST\", a, !t), addLDHeaders(o), o.setRequestHeader(\"Content-Type\", \"application/json\"), o.setRequestHeader(\"X-LaunchDarkly-Event-Schema\", \"3\"), t || (o.addEventListener(\"load\", function () {\n          o.status >= 400 && isHttpErrorRecoverable(o.status) && r ? n(!1).send(s) : e(function (e) {\n            var n = {\n              status: e.status\n            },\n                t = e.getResponseHeader(\"Date\");\n\n            if (t) {\n              var r = Date.parse(t);\n              r && (n.serverTime = r);\n            }\n\n            return n;\n          }(o));\n        }), r && o.addEventListener(\"error\", function () {\n          n(!1).send(s);\n        })), o;\n      })(!0).send(s);else {\n        var r = i + \"?d=\" + base64URLEncode(s);\n        o(r, t ? null : e);\n      }\n    };\n\n    if (!t) return new Promise(function (e) {\n      c(e);\n    });\n    c();\n  }\n\n  return s.sendEvents = function (n, r) {\n    void 0 === o && (o = void 0 === t ? \"withCredentials\" in new window.XMLHttpRequest() : t);\n    var a = void 0 !== r && r,\n        i = void 0;\n    i = o ? [n] : chunkUserEventsForUrl(MAX_URL_LENGTH - e.length, n);\n\n    for (var s = [], u = 0; u < i.length; u++) {\n      s.push(c(i[u], o, a));\n    }\n\n    return r ? Promise.resolve() : Promise.all(s);\n  }, s;\n}\n\nfunction EventSummarizer() {\n  var e = {},\n      n = 0,\n      t = 0,\n      r = {};\n  return e.summarizeEvent = function (e) {\n    if (\"feature\" === e.kind) {\n      var o = e.key + \":\" + (null !== e.variation && void 0 !== e.variation ? e.variation : \"\") + \":\" + (null !== e.version && void 0 !== e.version ? e.version : \"\"),\n          a = r[o];\n      a ? a.count = a.count + 1 : r[o] = {\n        count: 1,\n        key: e.key,\n        variation: e.variation,\n        version: e.version,\n        value: e.value,\n        default: e.default\n      }, (0 === n || e.creationDate < n) && (n = e.creationDate), e.creationDate > t && (t = e.creationDate);\n    }\n  }, e.getSummary = function () {\n    var e = {},\n        o = !0;\n\n    for (var a in r) {\n      var i = r[a],\n          s = e[i.key];\n      s || (s = {\n        default: i.default,\n        counters: []\n      }, e[i.key] = s);\n      var u = {\n        value: i.value,\n        count: i.count\n      };\n      void 0 !== i.variation && null !== i.variation && (u.variation = i.variation), i.version ? u.version = i.version : u.unknown = !0, s.counters.push(u), o = !1;\n    }\n\n    return o ? null : {\n      startDate: n,\n      endDate: t,\n      features: e\n    };\n  }, e.clearSummary = function () {\n    n = 0, t = 0, r = {};\n  }, e;\n}\n\nvar docLink = \" Please see https://docs.launchdarkly.com/docs/js-sdk-reference#section-initializing-the-client for instructions on SDK initialization.\",\n    localStorageUnavailable = function localStorageUnavailable() {\n  return \"localStorage is unavailable\";\n},\n    unknownCustomEventKey = function unknownCustomEventKey(e) {\n  return 'Custom event \"' + e + '\" does not exist';\n},\n    environmentNotFound = function environmentNotFound() {\n  return \"environment not found.\" + docLink;\n},\n    environmentNotSpecified = function environmentNotSpecified() {\n  return \"No environment specified.\" + docLink;\n},\n    errorFetchingFlags = function errorFetchingFlags(e) {\n  return \"Error fetching flag settings: \" + (e.message || e);\n},\n    userNotSpecified = function userNotSpecified() {\n  return \"No user specified.\" + docLink;\n},\n    invalidUser = function invalidUser() {\n  return \"Invalid user specified.\" + docLink;\n},\n    bootstrapOldFormat = function bootstrapOldFormat() {\n  return \"LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. Events may not be sent correctly.\" + docLink;\n},\n    bootstrapInvalid = function bootstrapInvalid() {\n  return \"LaunchDarkly bootstrap data is not available because the back end could not read the flags.\";\n},\n    deprecated = function deprecated(e, n) {\n  return '[LaunchDarkly] \"' + e + '\" is deprecated, please use \"' + n + '\"';\n},\n    httpErrorMessage = function httpErrorMessage(e, n, t) {\n  return \"Received error \" + e + (401 === e ? \" (invalid SDK key)\" : \"\") + \" for \" + n + \" - \" + (isHttpErrorRecoverable(e) ? t : \"giving up permanently\");\n};\n\nfunction UserFilter(e) {\n  var n = {},\n      t = void 0 !== e.allAttributesPrivate ? e.allAttributesPrivate : e.all_attributes_private,\n      r = (void 0 !== e.privateAttributeNames ? e.privateAttributeNames : e.private_attribute_names) || [],\n      o = {\n    key: !0,\n    custom: !0,\n    anonymous: !0\n  },\n      a = {\n    key: !0,\n    secondary: !0,\n    ip: !0,\n    country: !0,\n    email: !0,\n    firstName: !0,\n    lastName: !0,\n    avatar: !0,\n    name: !0,\n    anonymous: !0,\n    custom: !0\n  };\n  return void 0 !== e.all_attributes_private && console && console.warn && console.warn(deprecated(\"all_attributes_private\", \"allAttributesPrivate\")), void 0 !== e.private_attribute_names && console && console.warn && console.warn(deprecated(\"private_attribute_names\", \"privateAttributeNames\")), n.filterUser = function (e) {\n    if (!e) return null;\n\n    var n = e.privateAttributeNames || [],\n        i = function i(e, a) {\n      return Object.keys(e).reduce(function (i, s) {\n        var u = i;\n        return a(s) && (!function (e) {\n          return !o[e] && (t || -1 !== n.indexOf(e) || -1 !== r.indexOf(e));\n        }(s) ? u[0][s] = e[s] : u[1][s] = !0), u;\n      }, [{}, {}]);\n    },\n        s = i(e, function (e) {\n      return a[e];\n    }),\n        u = s[0],\n        c = s[1];\n\n    if (e.custom) {\n      var l = i(e.custom, function () {\n        return !0;\n      });\n      u.custom = l[0], c = extend({}, c, l[1]);\n    }\n\n    var v = Object.keys(c);\n    return v.length && (v.sort(), u.privateAttrs = v), u;\n  }, n;\n}\n\nfunction EventProcessor(e, n) {\n  var t = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},\n      r = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : null,\n      o = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : null,\n      a = {},\n      i = o || EventSender(e, n),\n      s = EventSummarizer(),\n      u = UserFilter(t),\n      c = !!t.inlineUsersInEvents,\n      l = [],\n      v = void 0,\n      d = void 0,\n      f = 0,\n      p = !1,\n      g = void 0;\n\n  function y(e) {\n    onNextTick(function () {\n      r && r.maybeReportError(new LDInvalidArgumentError(e));\n    });\n  }\n\n  function h() {\n    return 0 === d || 0 === Math.floor(Math.random() * d);\n  }\n\n  return void 0 !== t.samplingInterval && (isNaN(t.samplingInterval) || t.samplingInterval < 0) ? (d = 0, y(\"Invalid sampling interval configured. Sampling interval must be an integer >= 0.\")) : d = t.samplingInterval || 0, void 0 !== t.flushInterval && (isNaN(t.flushInterval) || t.flushInterval < 2e3) ? (v = 2e3, y(\"Invalid flush interval configured. Must be an integer >= 2000 (milliseconds).\")) : v = t.flushInterval || 2e3, a.enqueue = function (e) {\n    if (!p) {\n      var n,\n          t = !1,\n          r = !1;\n\n      if (s.summarizeEvent(e), \"feature\" === e.kind ? h() && (t = !!e.trackEvents, r = !!(n = e).debugEventsUntilDate && n.debugEventsUntilDate > f && n.debugEventsUntilDate > new Date().getTime()) : t = h(), t && l.push(function (e) {\n        var n = extend({}, e);\n        return c || \"identify\" === e.kind ? n.user = u.filterUser(e.user) : (n.userKey = e.user.key, delete n.user), \"feature\" === e.kind && (delete n.trackEvents, delete n.debugEventsUntilDate), n;\n      }(e)), r) {\n        var o = extend({}, e, {\n          kind: \"debug\"\n        });\n        delete o.trackEvents, delete o.debugEventsUntilDate, delete o.variation, l.push(o);\n      }\n    }\n  }, a.flush = function (e) {\n    if (p) return Promise.resolve();\n    var n = l,\n        t = s.getSummary();\n    return s.clearSummary(), t && (t.kind = \"summary\", n.push(t)), 0 === n.length ? Promise.resolve() : (l = [], i.sendEvents(n, e).then(function (e) {\n      e && (e.serverTime && (f = e.serverTime), isHttpErrorRecoverable(e.status) || (p = !0), e.status >= 400 && onNextTick(function () {\n        r.maybeReportError(new LDUnexpectedResponseError(httpErrorMessage(e.status, \"event posting\", \"some events were dropped\")));\n      }));\n    }));\n  }, a.start = function () {\n    g = setTimeout(function e() {\n      a.flush(), g = setTimeout(e, v);\n    }, v);\n  }, a.stop = function () {\n    clearTimeout(g);\n  }, a;\n}\n\nfunction EventEmitter() {\n  var e = {},\n      n = {};\n  return e.on = function (e, t, r) {\n    n[e] = n[e] || [], n[e] = n[e].concat({\n      handler: t,\n      context: r\n    });\n  }, e.off = function (e, t, r) {\n    if (n[e]) for (var o = 0; o < n[e].length; o++) {\n      n[e][o].handler === t && n[e][o].context === r && (n[e] = n[e].slice(0, o).concat(n[e].slice(o + 1)));\n    }\n  }, e.emit = function (e) {\n    if (n[e]) for (var t = 0; t < n[e].length; t++) {\n      n[e][t].handler.apply(n[e][t].context, Array.prototype.slice.call(arguments, 1));\n    }\n  }, e.getEvents = function () {\n    return Object.keys(n);\n  }, e.getEventListenerCount = function (e) {\n    return n[e] ? n[e].length : 0;\n  }, e.maybeReportError = function (e) {\n    e && (n[\"error\"] ? this.emit(\"error\", e) : console.error(e.message));\n  }, e;\n}\n\nvar matchOperatorsRe = /[|\\\\{}()[\\]^$+*?.]/g,\n    escapeStringRegexp = function escapeStringRegexp(e) {\n  if (\"string\" != typeof e) throw new TypeError(\"Expected a string\");\n  return e.replace(matchOperatorsRe, \"\\\\$&\");\n};\n\nfunction doesUrlMatch(e, n, t, r) {\n  var o = n.replace(t, \"\").replace(r, \"\"),\n      a = void 0,\n      i = void 0;\n\n  switch (e.kind) {\n    case \"exact\":\n      i = n, a = new RegExp(\"^\" + escapeStringRegexp(e.url) + \"/?$\");\n      break;\n\n    case \"canonical\":\n      i = o, a = new RegExp(\"^\" + escapeStringRegexp(e.url) + \"/?$\");\n      break;\n\n    case \"substring\":\n      i = o, a = new RegExp(\".*\" + escapeStringRegexp(e.substring) + \".*$\");\n      break;\n\n    case \"regex\":\n      i = o, a = new RegExp(e.pattern);\n      break;\n\n    default:\n      return !1;\n  }\n\n  return a.test(i);\n}\n\nfunction findGoalsForClick(e, n) {\n  for (var t = [], r = 0; r < n.length; r++) {\n    for (var o = e.target, a = n[r], i = a.selector, s = document.querySelectorAll(i); o && s.length > 0;) {\n      for (var u = 0; u < s.length; u++) {\n        o === s[u] && t.push(a);\n      }\n\n      o = o.parentNode;\n    }\n  }\n\n  return t;\n}\n\nfunction GoalTracker(e, n) {\n  for (var t = {}, r = null, o = [], a = 0; a < e.length; a++) {\n    for (var i = e[a], s = i.urls || [], u = 0; u < s.length; u++) {\n      if (doesUrlMatch(s[u], window.location.href, window.location.search, window.location.hash)) {\n        \"pageview\" === i.kind ? n(\"pageview\", i) : (o.push(i), n(\"click_pageview\", i));\n        break;\n      }\n    }\n  }\n\n  return o.length > 0 && (r = function r(e) {\n    for (var t = findGoalsForClick(e, o), r = 0; r < t.length; r++) {\n      n(\"click\", t[r]);\n    }\n  }, document.addEventListener(\"click\", r)), t.dispose = function () {\n    document.removeEventListener(\"click\", r);\n  }, t;\n}\n\nfunction Store(e, n, t) {\n  var r = {};\n\n  function o() {\n    var r = \"\",\n        o = t.getUser();\n    return o && (r = n || btoa(JSON.stringify(o))), \"ld:\" + e + \":\" + r;\n  }\n\n  return r.loadFlags = function () {\n    var e = o(),\n        n = void 0,\n        t = void 0;\n\n    try {\n      n = window.localStorage.getItem(e);\n    } catch (e) {\n      return console.warn(localStorageUnavailable()), null;\n    }\n\n    try {\n      t = JSON.parse(n);\n    } catch (e) {\n      return r.clearFlags(), null;\n    }\n\n    if (t) {\n      var a = t.$schema;\n      (void 0 === a || a < 1) && (t = transformValuesToVersionedValues(t));\n    }\n\n    return t;\n  }, r.saveFlags = function (e) {\n    var n = o(),\n        t = extend({}, e, {\n      $schema: 1\n    });\n\n    try {\n      window.localStorage.setItem(n, JSON.stringify(t));\n    } catch (e) {\n      console.warn(localStorageUnavailable());\n    }\n  }, r.clearFlags = function () {\n    var e = o();\n\n    try {\n      window.localStorage.removeItem(e);\n    } catch (e) {}\n  }, r;\n}\n\nfunction Stream(e, n, t, r) {\n  var o = {},\n      a = e + \"/eval/\" + n + \"/\",\n      i = r && r.useReport || !1,\n      s = r && r.evaluationReasons || !1,\n      u = r && r.streamReconnectDelay || 1e3,\n      c = 3e5,\n      l = null,\n      v = null,\n      d = null,\n      f = null;\n\n  function p() {\n    h(), g(u);\n  }\n\n  function g(e) {\n    v || (e ? v = setTimeout(y, e) : y());\n  }\n\n  function y() {\n    var r = void 0,\n        o = \"\";\n\n    if (void 0 !== window.EventSource) {\n      i ? r = e + \"/ping/\" + n : (r = a + base64URLEncode(JSON.stringify(d)), null != t && (o = \"h=\" + t)), s && (o = o + (o ? \"&\" : \"\") + \"withReasons=true\"), r = r + (o ? \"?\" : \"\") + o, h();\n      var u = {\n        heartbeatTimeout: c,\n        silentTimeout: c\n      };\n\n      for (var v in l = new window.EventSource(r, u), f) {\n        f.hasOwnProperty(v) && l.addEventListener(v, f[v]);\n      }\n\n      l.onerror = p;\n    }\n  }\n\n  function h() {\n    l && (l.close(), l = null);\n  }\n\n  return o.connect = function (e, n) {\n    d = e, f = n, g();\n  }, o.disconnect = function () {\n    clearTimeout(v), v = null, h();\n  }, o.isConnected = function () {\n    return l && (l.readyState === window.EventSource.OPEN || l.readyState === window.EventSource.CONNECTING);\n  }, o;\n}\n\nvar json = \"application/json\";\n\nfunction fetchJSON(e, n, t, r) {\n  var o = new window.XMLHttpRequest(),\n      a = void 0;\n  return o.addEventListener(\"load\", function () {\n    200 === o.status && o.getResponseHeader(\"Content-type\") && 0 === o.getResponseHeader(\"Content-Type\").lastIndexOf(json) ? t(null, JSON.parse(o.responseText)) : t(getResponseError(o));\n  }), o.addEventListener(\"error\", function () {\n    t(getResponseError(o));\n  }), n ? (o.open(\"REPORT\", e), o.setRequestHeader(\"Content-Type\", \"application/json\"), a = JSON.stringify(n)) : o.open(\"GET\", e), r && addLDHeaders(o), o.send(a), o;\n}\n\nfunction getResponseError(e) {\n  return 404 === e.status ? new LDInvalidEnvironmentIdError(environmentNotFound()) : e.statusText;\n}\n\nfunction Requestor(e, n, t, r, o) {\n  var a = void 0,\n      i = void 0,\n      s = {\n    fetchFlagSettings: function fetchFlagSettings(s, u, c) {\n      var l = void 0,\n          v = void 0,\n          d = \"\",\n          f = void 0,\n          p = void 0;\n      t ? (v = [e, \"/sdk/evalx/\", n, \"/user\"].join(\"\"), f = s) : (l = base64URLEncode(JSON.stringify(s)), v = [e, \"/sdk/evalx/\", n, \"/users/\", l].join(\"\")), u && (d = \"h=\" + u), r && (d = d + (d ? \"&\" : \"\") + \"withReasons=true\"), v = v + (d ? \"?\" : \"\") + d;\n      var g,\n          y,\n          h = (g = c, function (e, n) {\n        g(e, n), a = null, i = null;\n      });\n      a ? (a.abort(), y = i, p = function p() {\n        y && y.apply(null, arguments), h.apply(null, arguments);\n      }) : p = h, i = p, a = fetchJSON(v, f, p, o);\n    },\n    fetchGoals: function fetchGoals(t) {\n      fetchJSON([e, \"/sdk/goals/\", n].join(\"\"), null, t, o);\n    }\n  };\n  return s;\n}\n\nfunction sanitizeUser(e) {\n  var n = clone(e);\n  return n.key && (n.key = n.key.toString()), n;\n}\n\nfunction Identity(e, n) {\n  var t = {},\n      r = void 0;\n  return t.setUser = function (e) {\n    r = sanitizeUser(e), n(clone(r));\n  }, t.getUser = function () {\n    return r ? clone(r) : null;\n  }, e && t.setUser(e), t;\n}\n\nvar _typeof$1 = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n  return typeof e;\n} : function (e) {\n  return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n},\n    readyEvent = \"ready\",\n    successEvent = \"initialized\",\n    failedEvent = \"failed\",\n    changeEvent = \"change\",\n    goalsEvent = \"goalsReady\",\n    locationWatcherInterval = 300;\n\nfunction initialize(e, n) {\n  var t = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},\n      r = t.baseUrl || \"https://app.launchdarkly.com\",\n      o = t.eventsUrl || \"https://events.launchdarkly.com\",\n      a = t.streamUrl || \"https://clientstream.launchdarkly.com\",\n      i = t.hash,\n      s = R(\"sendEvents\", !0),\n      u = R(\"sendLDHeaders\", !0),\n      c = !!t.allowFrequentDuplicateEvents,\n      l = !!t.sendEventsOnlyForVariation,\n      v = void 0 === t.fetchGoals || t.fetchGoals,\n      d = e,\n      f = EventEmitter(),\n      p = Stream(a, d, i, t),\n      g = t.eventProcessor || EventProcessor(o, d, t, f),\n      y = Requestor(r, d, t.useReport, t.evaluationReasons, u),\n      h = {},\n      m = \"object\" === _typeof$1(t.bootstrap) ? function (e) {\n    var n = Object.keys(e),\n        t = e.$flagsState;\n    !t && n.length && console.warn(bootstrapOldFormat());\n    !1 === e.$valid && console.warn(bootstrapInvalid());\n    var r = {};\n    return n.forEach(function (n) {\n      if (\"$flagsState\" !== n && \"$valid\" !== n) {\n        var o = {\n          value: e[n]\n        };\n        t && t[n] ? o = extend(o, t[n]) : o.version = 0, r[n] = o;\n      }\n    }), r;\n  }(t.bootstrap) : {},\n      E = void 0,\n      k = void 0,\n      w = void 0,\n      b = void 0,\n      S = void 0,\n      L = void 0,\n      D = !0;\n\n  function R(e, n) {\n    return void 0 === t[e] ? n : t[e];\n  }\n\n  function U() {\n    return s && !function () {\n      var e = void 0;\n      e = window.navigator && void 0 !== window.navigator.doNotTrack ? window.navigator.doNotTrack : window.navigator && void 0 !== window.navigator.msDoNotTrack ? window.navigator.msDoNotTrack : window.doNotTrack;\n      return \"1\" === e || \"yes\" === e;\n    }();\n  }\n\n  function N(e) {\n    e.user ? (D = !1, U() && g.enqueue(e)) : D && (console && console.warn && console.warn(\"Be sure to call `identify` in the LaunchDarkly client: http://docs.launchdarkly.com/docs/running-an-ab-test#include-the-client-side-snippet\"), D = !1);\n  }\n\n  var T = Identity(n, function (e) {\n    e && N({\n      kind: \"identify\",\n      key: e.key,\n      user: e,\n      creationDate: new Date().getTime()\n    });\n  }),\n      x = Store(d, i, T);\n\n  function F(e, n, t) {\n    var r = T.getUser(),\n        o = new Date(),\n        a = n ? n.value : null;\n\n    if (!c) {\n      var i = JSON.stringify(a) + (r && r.key ? r.key : \"\") + e,\n          s = h[i];\n      if (s && o - s < 3e5) return;\n      h[i] = o;\n    }\n\n    var u = {\n      kind: \"feature\",\n      key: e,\n      user: r,\n      value: a,\n      variation: n ? n.variationIndex : null,\n      default: t,\n      creationDate: o.getTime(),\n      reason: n ? n.reason : null\n    },\n        l = m[e];\n    l && (u.version = l.flagVersion ? l.flagVersion : l.version, u.trackEvents = l.trackEvents, u.debugEventsUntilDate = l.debugEventsUntilDate), N(u);\n  }\n\n  function O(e, n) {\n    var t = {\n      kind: e,\n      key: n.key,\n      data: null,\n      url: window.location.href,\n      user: T.getUser(),\n      creationDate: new Date().getTime()\n    };\n    return \"click\" === e && (t.selector = n.selector), N(t);\n  }\n\n  function I(e, n, t) {\n    var r = void 0;\n\n    if (m && m.hasOwnProperty(e) && m[e] && !m[e].deleted) {\n      var o = m[e];\n      r = C(o), null !== o.value && void 0 !== o.value || (r.value = n);\n    } else r = {\n      value: n,\n      variationIndex: null,\n      reason: {\n        kind: \"ERROR\",\n        errorKind: \"FLAG_NOT_FOUND\"\n      }\n    };\n\n    return t && F(e, r, n), r;\n  }\n\n  function C(e) {\n    return {\n      value: e.value,\n      variationIndex: void 0 === e.variation ? null : e.variation,\n      reason: e.reason || null\n    };\n  }\n\n  function A() {\n    b = !0, T.getUser() && p.connect(T.getUser(), {\n      ping: function ping() {\n        y.fetchFlagSettings(T.getUser(), i, function (e, n) {\n          e && f.maybeReportError(new LDFlagFetchError(errorFetchingFlags(e))), _(n);\n        });\n      },\n      put: function put(e) {\n        _(JSON.parse(e.data));\n      },\n      patch: function patch(e) {\n        var n = JSON.parse(e.data),\n            t = m[n.key];\n\n        if (!t || !t.version || !n.version || t.version < n.version) {\n          var r = {},\n              o = extend({}, n);\n          delete o.key, m[n.key] = o;\n          var a = C(o);\n          r[n.key] = t ? {\n            previous: t.value,\n            current: a\n          } : {\n            current: a\n          }, j(r);\n        }\n      },\n      delete: function _delete(e) {\n        var n = JSON.parse(e.data);\n\n        if (!m[n.key] || m[n.key].version < n.version) {\n          var t = {};\n          m[n.key] && !m[n.key].deleted && (t[n.key] = {\n            previous: m[n.key].value\n          }), m[n.key] = {\n            version: n.version,\n            deleted: !0\n          }, j(t);\n        }\n      }\n    });\n  }\n\n  function P() {\n    b && (p.disconnect(), b = !1);\n  }\n\n  function _(e) {\n    var n = {};\n\n    if (e) {\n      for (var t in m) {\n        m.hasOwnProperty(t) && m[t] && (e[t] && !deepEquals(e[t].value, m[t].value) ? n[t] = {\n          previous: m[t].value,\n          current: C(e[t])\n        } : e[t] && !e[t].deleted || (n[t] = {\n          previous: m[t].value\n        }));\n      }\n\n      for (var r in e) {\n        e.hasOwnProperty(r) && e[r] && (!m[r] || m[r].deleted) && (n[r] = {\n          current: C(e[r])\n        });\n      }\n\n      m = e, j(n);\n    }\n  }\n\n  function j(e) {\n    var n = Object.keys(e);\n\n    if (k && x.saveFlags(m), n.length > 0) {\n      var t = {};\n      n.forEach(function (n) {\n        var r = e[n].current,\n            o = r ? r.value : void 0,\n            a = e[n].previous;\n        f.emit(changeEvent + \":\" + n, o, a), t[n] = r ? {\n          current: o,\n          previous: a\n        } : {\n          previous: a\n        };\n      }), f.emit(changeEvent, t), l || n.forEach(function (n) {\n        F(n, e[n].current);\n      });\n    }\n  }\n\n  function H(e) {\n    var n = null === e ? void 0 : e;\n\n    if (n !== S) {\n      var t = (S = n) || L && void 0 === S;\n      t && !b ? A() : !t && b && P();\n    }\n  }\n\n  function J(e) {\n    return e === changeEvent || e.substr(0, changeEvent.length + 1) === changeEvent + \":\";\n  }\n\n  function q() {\n    E && E.dispose(), w && w.length && (E = GoalTracker(w, O));\n  }\n\n  function z() {\n    void 0 !== t.streaming && H(t.streaming), f.emit(readyEvent), f.emit(successEvent);\n  }\n\n  function G(e) {\n    f.maybeReportError(e), f.emit(failedEvent, e), f.emit(readyEvent);\n  }\n\n  function V() {\n    s && g.start();\n  }\n\n  e || onNextTick(function () {\n    f.maybeReportError(new LDInvalidEnvironmentIdError(environmentNotSpecified()));\n  }), n ? n.key || onNextTick(function () {\n    f.maybeReportError(new LDInvalidUserError(invalidUser()));\n  }) : onNextTick(function () {\n    f.maybeReportError(new LDInvalidUserError(userNotSpecified()));\n  }), \"object\" === _typeof$1(t.bootstrap) ? onNextTick(z) : \"string\" == typeof t.bootstrap && \"LOCALSTORAGE\" === t.bootstrap.toUpperCase() && window.localStorage ? (k = !0, null === (m = x.loadFlags()) ? (m = {}, y.fetchFlagSettings(T.getUser(), i, function (e, n) {\n    e ? G(new LDFlagFetchError(errorFetchingFlags(e))) : (n ? _(n) : m = {}, z());\n  })) : (onNextTick(z), y.fetchFlagSettings(T.getUser(), i, function (e, n) {\n    e && f.maybeReportError(new LDFlagFetchError(errorFetchingFlags(e))), n && _(n);\n  }))) : y.fetchFlagSettings(T.getUser(), i, function (e, n) {\n    e ? (m = {}, G(new LDFlagFetchError(errorFetchingFlags(e)))) : (m = n || {}, z());\n  }), v && y.fetchGoals(function (e, n) {\n    e && f.maybeReportError(new LDUnexpectedResponseError((e.message, e.message))), n && n.length > 0 && (E = GoalTracker(w = n, O), function (e, n) {\n      var t = window.location.href,\n          r = void 0;\n\n      function o() {\n        (r = window.location.href) !== t && (t = r, n());\n      }\n\n      !function e(n, t) {\n        n(), setTimeout(function () {\n          e(n, t);\n        }, t);\n      }(o, e), window.history && window.history.pushState ? window.addEventListener(\"popstate\", o) : window.addEventListener(\"hashchange\", o);\n    }(locationWatcherInterval, q)), f.emit(goalsEvent);\n  }), \"complete\" !== document.readyState ? window.addEventListener(\"load\", V) : V(), window.addEventListener(\"beforeunload\", function () {\n    s && (g.stop(), g.flush(!0));\n  }), window.addEventListener(\"message\", function (e) {\n    if (e.origin === r && \"SYN\" === e.data.type) {\n      window.editorClientBaseUrl = r;\n      var n = document.createElement(\"script\");\n      n.type = \"text/javascript\", n.async = !0, n.src = r + e.data.editorClientUrl;\n      var t = document.getElementsByTagName(\"script\")[0];\n      t.parentNode.insertBefore(n, t);\n    }\n  });\n  var $ = new Promise(function (e) {\n    var n = f.on(readyEvent, function () {\n      f.off(readyEvent, n), e();\n    });\n  }),\n      B = new Promise(function (e) {\n    var n = f.on(goalsEvent, function () {\n      f.off(goalsEvent, n), e();\n    });\n  }),\n      M = new Promise(function (e, n) {\n    var t = f.on(successEvent, function () {\n      f.off(successEvent, t), e();\n    }),\n        r = f.on(failedEvent, function (e) {\n      f.off(failedEvent, r), n(e);\n    });\n  });\n  return {\n    waitForInitialization: function waitForInitialization() {\n      return M;\n    },\n    waitUntilReady: function waitUntilReady() {\n      return $;\n    },\n    waitUntilGoalsReady: function waitUntilGoalsReady() {\n      return B;\n    },\n    identify: function identify(e, n, t) {\n      return k && x.clearFlags(), wrapPromiseCallback(new Promise(function (t, r) {\n        if (e && null !== e.key && void 0 !== e.key) T.setUser(e), y.fetchFlagSettings(T.getUser(), n, function (e, n) {\n          if (e) return f.maybeReportError(new LDFlagFetchError(errorFetchingFlags(e))), r(e);\n          n && _(n), t(transformVersionedValuesToValues(n)), b && A();\n        });else {\n          var o = new LDInvalidUserError(e ? invalidUser() : userNotSpecified());\n          f.maybeReportError(o), r(o);\n        }\n      }), t);\n    },\n    variation: function variation(e, n) {\n      return I(e, n, !0).value;\n    },\n    variationDetail: function variationDetail(e, n) {\n      return I(e, n, !0);\n    },\n    track: function track(e, n) {\n      \"string\" == typeof e ? (w && !function (e) {\n        if (!w || 0 === w.length) return !1;\n\n        for (var n = 0; n < w.length; n++) {\n          if (\"custom\" === w[n].kind && w[n].key === e) return !0;\n        }\n\n        return !1;\n      }(e) && console.warn(unknownCustomEventKey(e)), N({\n        kind: \"custom\",\n        key: e,\n        data: n,\n        user: T.getUser(),\n        url: window.location.href,\n        creationDate: new Date().getTime()\n      })) : f.maybeReportError(new LDInvalidEventKeyError(unknownCustomEventKey(e)));\n    },\n    on: function on(e, n, t) {\n      J(e) ? (L = !0, b || void 0 !== S || A(), f.on(e, n, t)) : f.on.apply(f, arguments);\n    },\n    off: function off(e) {\n      if (f.off.apply(f, arguments), J(e)) {\n        var n = !1;\n        f.getEvents().forEach(function (e) {\n          J(e) && f.getEventListenerCount(e) > 0 && (n = !0);\n        }), n || (L = !1, b && void 0 === S && P());\n      }\n    },\n    setStreaming: H,\n    flush: function flush(e) {\n      return wrapPromiseCallback(new Promise(function (e) {\n        return s ? e(g.flush()) : e();\n      }, e));\n    },\n    allFlags: function allFlags() {\n      var e = {};\n      if (!m) return e;\n\n      for (var n in m) {\n        m.hasOwnProperty(n) && (e[n] = I(n, null, !l).value);\n      }\n\n      return e;\n    }\n  };\n}\n\nvar version = \"2.8.0\";\n\nfunction deprecatedInitialize(e, n) {\n  var t = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\n  return console && console.warn && console.warn(deprecated(\"default export\", \"named LDClient export\")), initialize(e, n, t);\n}\n\nvar index = {\n  initialize: deprecatedInitialize,\n  version: version\n};\nexport default index;\nexport { initialize, version };","map":null,"metadata":{},"sourceType":"module"}