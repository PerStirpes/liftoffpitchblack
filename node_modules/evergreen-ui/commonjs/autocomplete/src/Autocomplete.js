"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf3 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _fuzzaldrinPlus = _interopRequireDefault(require("fuzzaldrin-plus"));

var _downshift = _interopRequireDefault(require("downshift"));

var _reactTinyVirtualList = _interopRequireDefault(require("react-tiny-virtual-list"));

var _popover = require("../../popover");

var _constants = require("../../constants");

var _typography = require("../../typography");

var _layers = require("../../layers");

var _AutocompleteItem = _interopRequireDefault(require("./AutocompleteItem"));

var fuzzyFilter = function fuzzyFilter(items, input) {
  return _fuzzaldrinPlus.default.filter(items, input);
};

var autocompleteItemRenderer = function autocompleteItemRenderer(props) {
  return _react.default.createElement(_AutocompleteItem.default, props);
};

autocompleteItemRenderer.displayName = "autocompleteItemRenderer";

// https://github.com/paypal/downshift/issues/164
var Autocomplete =
/*#__PURE__*/
function (_PureComponent) {
  (0, _inherits2.default)(Autocomplete, _PureComponent);

  function Autocomplete() {
    var _getPrototypeOf2;

    var _this;

    (0, _classCallCheck2.default)(this, Autocomplete);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(Autocomplete)).call.apply(_getPrototypeOf2, [this].concat(args)));
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), "state", {
      targetWidth: 0
    });
    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), "renderResults", function (_ref) {
      var width = _ref.width,
          inputValue = _ref.inputValue,
          highlightedIndex = _ref.highlightedIndex,
          selectItemAtIndex = _ref.selectItemAtIndex,
          selectedItem = _ref.selectedItem,
          getItemProps = _ref.getItemProps;
      var _this$props = _this.props,
          title = _this$props.title,
          itemSize = _this$props.itemSize,
          itemsFilter = _this$props.itemsFilter,
          originalItems = _this$props.items,
          itemToString = _this$props.itemToString,
          _renderItem = _this$props.renderItem,
          popoverMaxHeight = _this$props.popoverMaxHeight,
          isFilterDisabled = _this$props.isFilterDisabled;
      var items = isFilterDisabled || inputValue.trim() === '' ? originalItems : itemsFilter(originalItems, inputValue);
      if (items.length === 0) return null;
      return _react.default.createElement(_layers.Pane, {
        width: width
      }, title && _react.default.createElement(_layers.Pane, {
        padding: 8,
        borderBottom: "muted"
      }, _react.default.createElement(_typography.Heading, {
        size: 100
      }, title)), items.length > 0 && _react.default.createElement(_reactTinyVirtualList.default, {
        width: "100%",
        height: Math.min(items.length * itemSize, popoverMaxHeight),
        itemSize: itemSize,
        itemCount: items.length,
        scrollToIndex: highlightedIndex || 0,
        overscanCount: 3,
        scrollToAlignment: "auto",
        renderItem: function renderItem(_ref2) {
          var index = _ref2.index,
              style = _ref2.style;
          var item = items[index];
          var itemString = itemToString(item);
          return _renderItem(getItemProps({
            item: item,
            key: itemString,
            index: index,
            style: style,
            children: itemString,
            onMouseUp: function onMouseUp() {
              selectItemAtIndex(index);
            },
            isSelected: itemToString(selectedItem) === itemString,
            isHighlighted: highlightedIndex === index
          }));
        }
      }));
    });
    return _this;
  }

  (0, _createClass2.default)(Autocomplete, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this.setState({
        targetWidth: this.targetRef.getBoundingClientRect().width
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props2 = this.props,
          children = _this$props2.children,
          itemSize = _this$props2.itemSize,
          position = _this$props2.position,
          renderItem = _this$props2.renderItem,
          itemsFilter = _this$props2.itemsFilter,
          popoverMaxHeight = _this$props2.popoverMaxHeight,
          popoverMinWidth = _this$props2.popoverMinWidth,
          defaultSelectedItem = _this$props2.defaultSelectedItem,
          props = (0, _objectWithoutProperties2.default)(_this$props2, ["children", "itemSize", "position", "renderItem", "itemsFilter", "popoverMaxHeight", "popoverMinWidth", "defaultSelectedItem"]);
      return _react.default.createElement(_downshift.default, (0, _extends2.default)({
        defaultSelectedItem: defaultSelectedItem
      }, props), function (_ref3) {
        var isShown = _ref3.isOpen,
            inputValue = _ref3.inputValue,
            getItemProps = _ref3.getItemProps,
            selectedItem = _ref3.selectedItem,
            highlightedIndex = _ref3.highlightedIndex,
            selectItemAtIndex = _ref3.selectItemAtIndex,
            getRootProps = _ref3.getRootProps,
            restDownshiftProps = (0, _objectWithoutProperties2.default)(_ref3, ["isOpen", "inputValue", "getItemProps", "selectedItem", "highlightedIndex", "selectItemAtIndex", "getRootProps"]);
        return _react.default.createElement(_layers.Pane, (0, _extends2.default)({
          width: "100%"
        }, getRootProps({
          refKey: 'innerRef'
        })), _react.default.createElement(_popover.Popover, {
          bringFocusInside: false,
          isShown: isShown,
          minWidth: popoverMinWidth,
          position: position || (_this2.state.targetWidth < popoverMinWidth ? _constants.Position.BOTTOM_LEFT : _constants.Position.BOTTOM),
          content: function content() {
            return _this2.renderResults({
              width: Math.max(_this2.state.targetWidth, popoverMinWidth),
              inputValue: inputValue,
              getItemProps: getItemProps,
              selectedItem: selectedItem,
              highlightedIndex: highlightedIndex,
              selectItemAtIndex: selectItemAtIndex
            });
          },
          minHeight: 0,
          animationDuration: 0
        }, function (_ref4) {
          var isShownPopover = _ref4.isShown,
              toggle = _ref4.toggle,
              _getRef = _ref4.getRef;
          return children((0, _objectSpread2.default)({
            isShown: isShownPopover,
            toggle: toggle,
            getRef: function getRef(ref) {
              // Use the ref internally to determine the width
              _this2.targetRef = ref;

              _getRef(ref);
            },
            inputValue: inputValue,
            selectedItem: selectedItem,
            highlightedIndex: highlightedIndex,
            selectItemAtIndex: selectItemAtIndex
          }, restDownshiftProps));
        }));
      });
    }
  }]);
  return Autocomplete;
}(_react.PureComponent);

exports.default = Autocomplete;
Autocomplete.displayName = "Autocomplete";
(0, _defineProperty2.default)(Autocomplete, "propTypes", (0, _objectSpread2.default)({
  /**
   * This prop can be either a string or a Node.
   * It will provide a title for the items
   */
  title: _propTypes.default.oneOfType([_propTypes.default.string, _propTypes.default.node]),

  /**
   * An array of items to be used as options for the select
   */
  items: _propTypes.default.array.isRequired,

  /**
   * The selected Item to be shown on the autocomplete
   */
  selectedItem: _propTypes.default.any,

  /**
   * The selected item to be selected & shown by default on the autocomplete
   */
  defaultSelectedItem: _propTypes.default.any,

  /**
   * In case the array of items is not an array of strings,
   * this function is used on each item to return the string that will be shown on the filter
   */
  itemToString: _propTypes.default.func.isRequired,

  /**
   * Function that will render the 'filter' component.
   */
  children: _propTypes.default.func.isRequired,

  /**
   * The height of each item in the list
   * Because the list is virtualized this is required beforehand.
   */
  itemSize: _propTypes.default.number,

  /**
   * Function that returns a component to render the item
   */
  renderItem: _propTypes.default.func,

  /**
   * The position of the Popover the Autocomplete is rendered in.
   */
  position: _propTypes.default.oneOf(Object.keys(_constants.Position)),

  /**
   * A function that is used to filter the items.
   * It should return a subset of the initial items.
   * By default the "fuzzaldrin-plus" package is used.
   */
  itemsFilter: _propTypes.default.func,

  /**
   * Prop that enables and disables filtering
   * True: Enables Filtering
   * False: Disables Filtering
   */
  isFilterDisabled: _propTypes.default.bool,

  /**
   * Defines the minimum height the results container will be
   */
  popoverMinWidth: _propTypes.default.number,

  /**
   * Defines the maximum height the results container will be
   */
  popoverMaxHeight: _propTypes.default.number
}, _downshift.default.propTypes));
(0, _defineProperty2.default)(Autocomplete, "defaultProps", {
  itemToString: function itemToString(i) {
    return i ? String(i) : '';
  },
  itemSize: 32,
  itemsFilter: fuzzyFilter,
  isFilterDisabled: false,
  popoverMinWidth: 240,
  popoverMaxHeight: 240,
  renderItem: autocompleteItemRenderer
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hdXRvY29tcGxldGUvc3JjL0F1dG9jb21wbGV0ZS5qcyJdLCJuYW1lcyI6WyJmdXp6eUZpbHRlciIsIml0ZW1zIiwiaW5wdXQiLCJmdXp6YWxkcmluIiwiZmlsdGVyIiwiYXV0b2NvbXBsZXRlSXRlbVJlbmRlcmVyIiwicHJvcHMiLCJBdXRvY29tcGxldGUiLCJ0YXJnZXRXaWR0aCIsIndpZHRoIiwiaW5wdXRWYWx1ZSIsImhpZ2hsaWdodGVkSW5kZXgiLCJzZWxlY3RJdGVtQXRJbmRleCIsInNlbGVjdGVkSXRlbSIsImdldEl0ZW1Qcm9wcyIsInRpdGxlIiwiaXRlbVNpemUiLCJpdGVtc0ZpbHRlciIsIm9yaWdpbmFsSXRlbXMiLCJpdGVtVG9TdHJpbmciLCJyZW5kZXJJdGVtIiwicG9wb3Zlck1heEhlaWdodCIsImlzRmlsdGVyRGlzYWJsZWQiLCJ0cmltIiwibGVuZ3RoIiwiTWF0aCIsIm1pbiIsImluZGV4Iiwic3R5bGUiLCJpdGVtIiwiaXRlbVN0cmluZyIsImtleSIsImNoaWxkcmVuIiwib25Nb3VzZVVwIiwiaXNTZWxlY3RlZCIsImlzSGlnaGxpZ2h0ZWQiLCJzZXRTdGF0ZSIsInRhcmdldFJlZiIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInBvc2l0aW9uIiwicG9wb3Zlck1pbldpZHRoIiwiZGVmYXVsdFNlbGVjdGVkSXRlbSIsImlzU2hvd24iLCJpc09wZW4iLCJnZXRSb290UHJvcHMiLCJyZXN0RG93bnNoaWZ0UHJvcHMiLCJyZWZLZXkiLCJzdGF0ZSIsIlBvc2l0aW9uIiwiQk9UVE9NX0xFRlQiLCJCT1RUT00iLCJyZW5kZXJSZXN1bHRzIiwibWF4IiwiaXNTaG93blBvcG92ZXIiLCJ0b2dnbGUiLCJnZXRSZWYiLCJyZWYiLCJQdXJlQ29tcG9uZW50IiwiUHJvcFR5cGVzIiwib25lT2ZUeXBlIiwic3RyaW5nIiwibm9kZSIsImFycmF5IiwiaXNSZXF1aXJlZCIsImFueSIsImZ1bmMiLCJudW1iZXIiLCJvbmVPZiIs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QUFRLEVBQUVtQixtQkFBVVMsS0FBVixDQUFnQkMsTUFBTSxDQUFDQyxJQUFQLENBQVlyQixtQkFBWixDQUFoQixDOztBQUVWOzs7OztBQUtBL0IsRUFBQUEsV0FBVyxFQUFFeUMsbUJBQVVPLEk7O0FBRXZCOzs7OztBQUtBM0MsRUFBQUEsZ0JBQWdCLEVBQUVvQyxtQkFBVVksSTs7QUFFNUI7OztBQUdBOUIsRUFBQUEsZUFBZSxFQUFFa0IsbUJBQVVRLE07O0FBRTNCOzs7QUFHQTdDLEVBQUFBLGdCQUFnQixFQUFFcUMsbUJBQVVRO0dBRXpCSyxtQkFBVUMsUzs4QkExRUlqRSxZLGtCQWlGRztBQUNwQlksRUFBQUEsWUFBWSxFQUFFLHNCQUFBc0QsQ0FBQztBQUFBLFdBQUtBLENBQUMsR0FBR0MsTUFBTSxDQUFDRCxDQUFELENBQVQsR0FBZSxFQUFyQjtBQUFBLEdBREs7QUFFcEJ6RCxFQUFBQSxRQUFRLEVBQUUsRUFGVTtBQUdwQkMsRUFBQUEsV0FBVyxFQUFFakIsV0FITztBQUlwQnNCLEVBQUFBLGdCQUFnQixFQUFFLEtBSkU7QUFLcEJrQixFQUFBQSxlQUFlLEVBQUUsR0FMRztBQU1wQm5CLEVBQUFBLGdCQUFnQixFQUFFLEdBTkU7QUFPcEJELEVBQUFBLFVBQVUsRUFBRWY7QUFQUSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IFB1cmVDb21wb25lbnQgfSBmcm9tICdyZWFjdCdcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcydcbmltcG9ydCBmdXp6YWxkcmluIGZyb20gJ2Z1enphbGRyaW4tcGx1cydcbmltcG9ydCBEb3duc2hpZnQgZnJvbSAnZG93bnNoaWZ0J1xuaW1wb3J0IFZpcnR1YWxMaXN0IGZyb20gJ3JlYWN0LXRpbnktdmlydHVhbC1saXN0J1xuaW1wb3J0IHsgUG9wb3ZlciB9IGZyb20gJy4uLy4uL3BvcG92ZXInXG5pbXBvcnQgeyBQb3NpdGlvbiB9IGZyb20gJy4uLy4uL2NvbnN0YW50cydcbmltcG9ydCB7IEhlYWRpbmcgfSBmcm9tICcuLi8uLi90eXBvZ3JhcGh5J1xuaW1wb3J0IHsgUGFuZSB9IGZyb20gJy4uLy4uL2xheWVycydcbmltcG9ydCBBdXRvY29tcGxldGVJdGVtIGZyb20gJy4vQXV0b2NvbXBsZXRlSXRlbSdcblxuY29uc3QgZnV6enlGaWx0ZXIgPSAoaXRlbXMsIGlucHV0KSA9PiBmdXp6YWxkcmluLmZpbHRlcihpdGVtcywgaW5wdXQpXG5cbmNvbnN0IGF1dG9jb21wbGV0ZUl0ZW1SZW5kZXJlciA9IHByb3BzID0+IDxBdXRvY29tcGxldGVJdGVtIHsuLi5wcm9wc30gLz5cblxuLy8gaHR0cHM6Ly9naXRodWIuY29tL3BheXBhbC9kb3duc2hpZnQvaXNzdWVzLzE2NFxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXV0b2NvbXBsZXRlIGV4dGVuZHMgUHVyZUNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgLyoqXG4gICAgICogVGhpcyBwcm9wIGNhbiBiZSBlaXRoZXIgYSBzdHJpbmcgb3IgYSBOb2RlLlxuICAgICAqIEl0IHdpbGwgcHJvdmlkZSBhIHRpdGxlIGZvciB0aGUgaXRlbXNcbiAgICAgKi9cbiAgICB0aXRsZTogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLm5vZGVdKSxcblxuICAgIC8qKlxuICAgICAqIEFuIGFycmF5IG9mIGl0ZW1zIHRvIGJlIHVzZWQgYXMgb3B0aW9ucyBmb3IgdGhlIHNlbGVjdFxuICAgICAqL1xuICAgIGl0ZW1zOiBQcm9wVHlwZXMuYXJyYXkuaXNSZXF1aXJlZCxcblxuICAgIC8qKlxuICAgICAqIFRoZSBzZWxlY3RlZCBJdGVtIHRvIGJlIHNob3duIG9uIHRoZSBhdXRvY29tcGxldGVcbiAgICAgKi9cbiAgICBzZWxlY3RlZEl0ZW06IFByb3BUeXBlcy5hbnksXG5cbiAgICAvKipcbiAgICAgKiBUaGUgc2VsZWN0ZWQgaXRlbSB0byBiZSBzZWxlY3RlZCAmIHNob3duIGJ5IGRlZmF1bHQgb24gdGhlIGF1dG9jb21wbGV0ZVxuICAgICAqL1xuICAgIGRlZmF1bHRTZWxlY3RlZEl0ZW06IFByb3BUeXBlcy5hbnksXG5cbiAgICAvKipcbiAgICAgKiBJbiBjYXNlIHRoZSBhcnJheSBvZiBpdGVtcyBpcyBub3QgYW4gYXJyYXkgb2Ygc3RyaW5ncyxcbiAgICAgKiB0aGlzIGZ1bmN0aW9uIGlzIHVzZWQgb24gZWFjaCBpdGVtIHRvIHJldHVybiB0aGUgc3RyaW5nIHRoYXQgd2lsbCBiZSBzaG93biBvbiB0aGUgZmlsdGVyXG4gICAgICovXG4gICAgaXRlbVRvU3RyaW5nOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuXG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdGhhdCB3aWxsIHJlbmRlciB0aGUgJ2ZpbHRlcicgY29tcG9uZW50LlxuICAgICAqL1xuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuXG4gICAgLyoqXG4gICAgICogVGhlIGhlaWdodCBvZiBlYWNoIGl0ZW0gaW4gdGhlIGxpc3RcbiAgICAgKiBCZWNhdXNlIHRoZSBsaXN0IGlzIHZpcnR1YWxpemVkIHRoaXMgaXMgcmVxdWlyZWQgYmVmb3JlaGFuZC5cbiAgICAgKi9cbiAgICBpdGVtU2l6ZTogUHJvcFR5cGVzLm51bWJlcixcblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGNvbXBvbmVudCB0byByZW5kZXIgdGhlIGl0ZW1cbiAgICAgKi9cbiAgICByZW5kZXJJdGVtOiBQcm9wVHlwZXMuZnVuYyxcblxuICAgIC8qKlxuICAgICAqIFRoZSBwb3NpdGlvbiBvZiB0aGUgUG9wb3ZlciB0aGUgQXV0b2NvbXBsZXRlIGlzIHJlbmRlcmVkIGluLlxuICAgICAqL1xuICAgIHBvc2l0aW9uOiBQcm9wVHlwZXMub25lT2YoT2JqZWN0LmtleXMoUG9zaXRpb24pKSxcblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdGhhdCBpcyB1c2VkIHRvIGZpbHRlciB0aGUgaXRlbXMuXG4gICAgICogSXQgc2hvdWxkIHJldHVybiBhIHN1YnNldCBvZiB0aGUgaW5pdGlhbCBpdGVtcy5cbiAgICAgKiBCeSBkZWZhdWx0IHRoZSBcImZ1enphbGRyaW4tcGx1c1wiIHBhY2thZ2UgaXMgdXNlZC5cbiAgICAgKi9cbiAgICBpdGVtc0ZpbHRlcjogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgICAvKipcbiAgICAgKiBQcm9wIHRoYXQgZW5hYmxlcyBhbmQgZGlzYWJsZXMgZmlsdGVyaW5nXG4gICAgICogVHJ1ZTogRW5hYmxlcyBGaWx0ZXJpbmdcbiAgICAgKiBGYWxzZTogRGlzYWJsZXMgRmlsdGVyaW5nXG4gICAgICovXG4gICAgaXNGaWx0ZXJEaXNhYmxlZDogUHJvcFR5cGVzLmJvb2wsXG5cbiAgICAvKipcbiAgICAgKiBEZWZpbmVzIHRoZSBtaW5pbXVtIGhlaWdodCB0aGUgcmVzdWx0cyBjb250YWluZXIgd2lsbCBiZVxuICAgICAqL1xuICAgIHBvcG92ZXJNaW5XaWR0aDogUHJvcFR5cGVzLm51bWJlcixcblxuICAgIC8qKlxuICAgICAqIERlZmluZXMgdGhlIG1heGltdW0gaGVpZ2h0IHRoZSByZXN1bHRzIGNvbnRhaW5lciB3aWxsIGJlXG4gICAgICovXG4gICAgcG9wb3Zlck1heEhlaWdodDogUHJvcFR5cGVzLm51bWJlcixcblxuICAgIC4uLkRvd25zaGlmdC5wcm9wVHlwZXNcbiAgfVxuXG4gIHN0YXRlID0ge1xuICAgIHRhcmdldFdpZHRoOiAwXG4gIH1cblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIGl0ZW1Ub1N0cmluZzogaSA9PiAoaSA/IFN0cmluZyhpKSA6ICcnKSxcbiAgICBpdGVtU2l6ZTogMzIsXG4gICAgaXRlbXNGaWx0ZXI6IGZ1enp5RmlsdGVyLFxuICAgIGlzRmlsdGVyRGlzYWJsZWQ6IGZhbHNlLFxuICAgIHBvcG92ZXJNaW5XaWR0aDogMjQwLFxuICAgIHBvcG92ZXJNYXhIZWlnaHQ6IDI0MCxcbiAgICByZW5kZXJJdGVtOiBhdXRvY29tcGxldGVJdGVtUmVuZGVyZXJcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgdGFyZ2V0V2lkdGg6IHRoaXMudGFyZ2V0UmVmLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoXG4gICAgfSlcbiAgfVxuXG4gIHJlbmRlclJlc3VsdHMgPSAoe1xuICAgIHdpZHRoLFxuICAgIGlucHV0VmFsdWUsXG4gICAgaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICBzZWxlY3RJdGVtQXRJbmRleCxcbiAgICBzZWxlY3RlZEl0ZW0sXG4gICAgZ2V0SXRlbVByb3BzXG4gIH0pID0+IHtcbiAgICBjb25zdCB7XG4gICAgICB0aXRsZSxcbiAgICAgIGl0ZW1TaXplLFxuICAgICAgaXRlbXNGaWx0ZXIsXG4gICAgICBpdGVtczogb3JpZ2luYWxJdGVtcyxcbiAgICAgIGl0ZW1Ub1N0cmluZyxcbiAgICAgIHJlbmRlckl0ZW0sXG4gICAgICBwb3BvdmVyTWF4SGVpZ2h0LFxuICAgICAgaXNGaWx0ZXJEaXNhYmxlZFxuICAgIH0gPSB0aGlzLnByb3BzXG5cbiAgICBjb25zdCBpdGVtcyA9XG4gICAgICBpc0ZpbHRlckRpc2FibGVkIHx8IGlucHV0VmFsdWUudHJpbSgpID09PSAnJ1xuICAgICAgICA/IG9yaWdpbmFsSXRlbXNcbiAgICAgICAgOiBpdGVtc0ZpbHRlcihvcmlnaW5hbEl0ZW1zLCBpbnB1dFZhbHVlKVxuXG4gICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGxcblxuICAgIHJldHVybiAoXG4gICAgICA8UGFuZSB3aWR0aD17d2lkdGh9PlxuICAgICAgICB7dGl0bGUgJiYgKFxuICAgICAgICAgIDxQYW5lIHBhZGRpbmc9ezh9IGJvcmRlckJvdHRvbT1cIm11dGVkXCI+XG4gICAgICAgICAgICA8SGVhZGluZyBzaXplPXsxMDB9Pnt0aXRsZX08L0hlYWRpbmc+XG4gICAgICAgICAgPC9QYW5lPlxuICAgICAgICApfVxuICAgICAgICB7aXRlbXMubGVuZ3RoID4gMCAmJiAoXG4gICAgICAgICAgPFZpcnR1YWxMaXN0XG4gICAgICAgICAgICB3aWR0aD1cIjEwMCVcIlxuICAgICAgICAgICAgaGVpZ2h0PXtNYXRoLm1pbihpdGVtcy5sZW5ndGggKiBpdGVtU2l6ZSwgcG9wb3Zlck1heEhlaWdodCl9XG4gICAgICAgICAgICBpdGVtU2l6ZT17aXRlbVNpemV9XG4gICAgICAgICAgICBpdGVtQ291bnQ9e2l0ZW1zLmxlbmd0aH1cbiAgICAgICAgICAgIHNjcm9sbFRvSW5kZXg9e2hpZ2hsaWdodGVkSW5kZXggfHwgMH1cbiAgICAgICAgICAgIG92ZXJzY2FuQ291bnQ9ezN9XG4gICAgICAgICAgICBzY3JvbGxUb0FsaWdubWVudD1cImF1dG9cIlxuICAgICAgICAgICAgcmVuZGVySXRlbT17KHsgaW5kZXgsIHN0eWxlIH0pID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zW2luZGV4XVxuICAgICAgICAgICAgICBjb25zdCBpdGVtU3RyaW5nID0gaXRlbVRvU3RyaW5nKGl0ZW0pXG4gICAgICAgICAgICAgIHJldHVybiByZW5kZXJJdGVtKFxuICAgICAgICAgICAgICAgIGdldEl0ZW1Qcm9wcyh7XG4gICAgICAgICAgICAgICAgICBpdGVtLFxuICAgICAgICAgICAgICAgICAga2V5OiBpdGVtU3RyaW5nLFxuICAgICAgICAgICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgICAgICAgICBzdHlsZSxcbiAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBpdGVtU3RyaW5nLFxuICAgICAgICAgICAgICAgICAgb25Nb3VzZVVwOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdEl0ZW1BdEluZGV4KGluZGV4KVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGlzU2VsZWN0ZWQ6IGl0ZW1Ub1N0cmluZyhzZWxlY3RlZEl0ZW0pID09PSBpdGVtU3RyaW5nLFxuICAgICAgICAgICAgICAgICAgaXNIaWdobGlnaHRlZDogaGlnaGxpZ2h0ZWRJbmRleCA9PT0gaW5kZXhcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9fVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICA8L1BhbmU+XG4gICAgKVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGNoaWxkcmVuLFxuICAgICAgaXRlbVNpemUsXG4gICAgICBwb3NpdGlvbixcbiAgICAgIHJlbmRlckl0ZW0sXG4gICAgICBpdGVtc0ZpbHRlcixcbiAgICAgIHBvcG92ZXJNYXhIZWlnaHQsXG4gICAgICBwb3BvdmVyTWluV2lkdGgsXG4gICAgICBkZWZhdWx0U2VsZWN0ZWRJdGVtLFxuICAgICAgLi4ucHJvcHNcbiAgICB9ID0gdGhpcy5wcm9wc1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxEb3duc2hpZnQgZGVmYXVsdFNlbGVjdGVkSXRlbT17ZGVmYXVsdFNlbGVjdGVkSXRlbX0gey4uLnByb3BzfT5cbiAgICAgICAgeyh7XG4gICAgICAgICAgaXNPcGVuOiBpc1Nob3duLFxuICAgICAgICAgIGlucHV0VmFsdWUsXG4gICAgICAgICAgZ2V0SXRlbVByb3BzLFxuICAgICAgICAgIHNlbGVjdGVkSXRlbSxcbiAgICAgICAgICBoaWdobGlnaHRlZEluZGV4LFxuICAgICAgICAgIHNlbGVjdEl0ZW1BdEluZGV4LFxuICAgICAgICAgIGdldFJvb3RQcm9wcyxcbiAgICAgICAgICAuLi5yZXN0RG93bnNoaWZ0UHJvcHNcbiAgICAgICAgfSkgPT4gKFxuICAgICAgICAgIDxQYW5lIHdpZHRoPVwiMTAwJVwiIHsuLi5nZXRSb290UHJvcHMoeyByZWZLZXk6ICdpbm5lclJlZicgfSl9PlxuICAgICAgICAgICAgPFBvcG92ZXJcbiAgICAgICAgICAgICAgYnJpbmdGb2N1c0luc2lkZT17ZmFsc2V9XG4gICAgICAgICAgICAgIGlzU2hvd249e2lzU2hvd259XG4gICAgICAgICAgICAgIG1pbldpZHRoPXtwb3BvdmVyTWluV2lkdGh9XG4gICAgICAgICAgICAgIHBvc2l0aW9uPXtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiB8fFxuICAgICAgICAgICAgICAgICh0aGlzLnN0YXRlLnRhcmdldFdpZHRoIDwgcG9wb3Zlck1pbldpZHRoXG4gICAgICAgICAgICAgICAgICA/IFBvc2l0aW9uLkJPVFRPTV9MRUZUXG4gICAgICAgICAgICAgICAgICA6IFBvc2l0aW9uLkJPVFRPTSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBjb250ZW50PXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyUmVzdWx0cyh7XG4gICAgICAgICAgICAgICAgICB3aWR0aDogTWF0aC5tYXgodGhpcy5zdGF0ZS50YXJnZXRXaWR0aCwgcG9wb3Zlck1pbldpZHRoKSxcbiAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUsXG4gICAgICAgICAgICAgICAgICBnZXRJdGVtUHJvcHMsXG4gICAgICAgICAgICAgICAgICBzZWxlY3RlZEl0ZW0sXG4gICAgICAgICAgICAgICAgICBoaWdobGlnaHRlZEluZGV4LFxuICAgICAgICAgICAgICAgICAgc2VsZWN0SXRlbUF0SW5kZXhcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBtaW5IZWlnaHQ9ezB9XG4gICAgICAgICAgICAgIGFuaW1hdGlvbkR1cmF0aW9uPXswfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7KHsgaXNTaG93bjogaXNTaG93blBvcG92ZXIsIHRvZ2dsZSwgZ2V0UmVmIH0pID0+XG4gICAgICAgICAgICAgICAgY2hpbGRyZW4oe1xuICAgICAgICAgICAgICAgICAgaXNTaG93bjogaXNTaG93blBvcG92ZXIsXG4gICAgICAgICAgICAgICAgICB0b2dnbGUsXG4gICAgICAgICAgICAgICAgICBnZXRSZWY6IHJlZiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSB0aGUgcmVmIGludGVybmFsbHkgdG8gZGV0ZXJtaW5lIHRoZSB3aWR0aFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRhcmdldFJlZiA9IHJlZlxuICAgICAgICAgICAgICAgICAgICBnZXRSZWYocmVmKVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUsXG4gICAgICAgICAgICAgICAgICBzZWxlY3RlZEl0ZW0sXG4gICAgICAgICAgICAgICAgICBoaWdobGlnaHRlZEluZGV4LFxuICAgICAgICAgICAgICAgICAgc2VsZWN0SXRlbUF0SW5kZXgsXG4gICAgICAgICAgICAgICAgICAuLi5yZXN0RG93bnNoaWZ0UHJvcHNcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8L1BvcG92ZXI+XG4gICAgICAgICAgPC9QYW5lPlxuICAgICAgICApfVxuICAgICAgPC9Eb3duc2hpZnQ+XG4gICAgKVxuICB9XG59XG4iXX0=