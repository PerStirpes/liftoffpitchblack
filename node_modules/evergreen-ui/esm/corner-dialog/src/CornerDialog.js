import _extends from "@babel/runtime/helpers/esm/extends";
import _classCallCheck from "@babel/runtime/helpers/esm/classCallCheck";
import _createClass from "@babel/runtime/helpers/esm/createClass";
import _possibleConstructorReturn from "@babel/runtime/helpers/esm/possibleConstructorReturn";
import _getPrototypeOf from "@babel/runtime/helpers/esm/getPrototypeOf";
import _inherits from "@babel/runtime/helpers/esm/inherits";
import _assertThisInitialized from "@babel/runtime/helpers/esm/assertThisInitialized";
import _defineProperty from "@babel/runtime/helpers/esm/defineProperty";
import React, { PureComponent } from 'react';
import PropTypes from 'prop-types';
import { css } from 'ui-box';
import Transition from 'react-transition-group/Transition';
import { Pane, Card } from '../../layers';
import { Portal } from '../../portal';
import { Paragraph, Heading } from '../../typography';
import { Button, IconButton } from '../../buttons';
var animationEasing = {
  deceleration: "cubic-bezier(0.0, 0.0, 0.2, 1)",
  acceleration: "cubic-bezier(0.4, 0.0, 1, 1)",
  spring: "cubic-bezier(0.175, 0.885, 0.320, 1.175)"
};
var ANIMATION_DURATION = 240;
var openAnimation = css.keyframes('openAnimation', {
  from: {
    transform: 'translateY(100%)'
  },
  to: {
    transform: 'translateY(0)'
  }
});
var closeAnimation = css.keyframes('closeAnimation', {
  from: {
    transform: 'scale(1)',
    opacity: 1
  },
  to: {
    transform: 'scale(0.9)',
    opacity: 0
  }
});
var animationStyles = {
  '&[data-state="entering"], &[data-state="entered"]': {
    animation: "".concat(openAnimation, " ").concat(ANIMATION_DURATION, "ms ").concat(animationEasing.spring, " both")
  },
  '&[data-state="exiting"]': {
    animation: "".concat(closeAnimation, " 120ms ").concat(animationEasing.acceleration, " both")
  }
};

var CornerDialog =
/*#__PURE__*/
function (_PureComponent) {
  _inherits(CornerDialog, _PureComponent);

  function CornerDialog(props) {
    var _this;

    _classCallCheck(this, CornerDialog);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(CornerDialog).call(this, props));

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "handleExited", function () {
      _this.setState({
        exiting: false,
        exited: true
      });

      _this.props.onCloseComplete();
    });

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "handleCancel", function () {
      _this.props.onCancel(_this.handleClose);
    });

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "handleClose", function () {
      _this.setState({
        exiting: true
      });
    });

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "handleConfirm", function () {
      _this.props.onConfirm(_this.handleClose);
    });

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "renderChildren", function () {
      var children = _this.props.children;

      if (typeof children === 'function') {
        return children({
          close: _this.handleClose
        });
      }

      if (typeof children === 'string') {
        return React.createElement(Paragraph, {
          size: 400,
          color: "muted"
        }, children);
      }

      return children;
    });

    _this.state = {
      exiting: false,
      exited: !props.isShown
    };
    return _this;
  }

  _createClass(CornerDialog, [{
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps) {
      if (!prevProps.isShown && this.props.isShown) {
        // eslint-disable-next-line react/no-did-update-set-state
        this.setState({
          exited: false
        });
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          title = _this$props.title,
          width = _this$props.width,
          intent = _this$props.intent,
          isShown = _this$props.isShown,
          hasFooter = _this$props.hasFooter,
          hasCancel = _this$props.hasCancel,
          cancelLabel = _this$props.cancelLabel,
          confirmLabel = _this$props.confirmLabel,
          onOpenComplete = _this$props.onOpenComplete,
          containerProps = _this$props.containerProps;
      var _this$state = this.state,
          exiting = _this$state.exiting,
          exited = _this$state.exited;
      if (exited) return null;
      return React.createElement(Portal, null, React.createElement(Transition, {
        appear: true,
        unmountOnExit: true,
        timeout: ANIMATION_DURATION,
        in: isShown && !exiting,
        onExited: this.handleExited,
        onEntered: onOpenComplete
      }, function (state) {
        return React.createElement(Card, _extends({
          role: "dialog",
          backgroundColor: "white",
          elevation: 4,
          width: width,
          css: animationStyles,
          "data-state": state,
          position: "fixed",
          bottom: 16,
          right: 16,
          padding: 32
        }, containerProps), React.createElement(Pane, {
          display: "flex",
          alignItems: "center",
          marginBottom: 12
        }, React.createElement(Heading, {
          is: "h4",
          size: 600,
          flex: "1"
        }, title), React.createElement(IconButton, {
          height: 32,
          icon: "cross",
          appearance: "minimal",
          onClick: _this2.handleClose
        })), React.createElement(Pane, {
          overflowY: "auto",
          "data-state": state
        }, _this2.renderChildren()), hasFooter && React.createElement(Pane, {
          marginTop: 24,
          flexShrink: 0,
          display: "flex",
          flexDirection: "row-reverse"
        }, React.createElement(Button, {
          appearance: "primary",
          intent: intent,
          marginLeft: 8,
          onClick: _this2.handleConfirm
        }, confirmLabel), hasCancel && React.createElement(Button, {
          onClick: _this2.handleCancel
        }, cancelLabel)));
      }));
    }
  }]);

  return CornerDialog;
}(PureComponent);

CornerDialog.displayName = "CornerDialog";

_defineProperty(CornerDialog, "propTypes", {
  /**
   * Children can be a string, node or a function accepting `({ close })`.
   * When passing a string, <Paragraph size={400} color="muted" /> is used to wrap the string.
   */
  children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]).isRequired,

  /**
   * The intent of the CornerDialog. Used for the button.
   */
  intent: PropTypes.oneOf(['none', 'success', 'warning', 'danger']).isRequired,

  /**
   * When true, the dialog is shown.
   */
  isShown: PropTypes.bool,

  /**
   * Title of the Dialog. Titles should use Title Case.
   */
  title: PropTypes.node,

  /**
   * Function that will be called when the exit transition is complete.
   */
  onCloseComplete: PropTypes.func,

  /**
   * Function that will be called when the enter transition is complete.
   */
  onOpenComplete: PropTypes.func,

  /**
   * When true, the footer with the cancel and confirm button is shown.
   */
  hasFooter: PropTypes.bool,

  /**
   * Function that will be called when the confirm button is clicked.
   * This does not close the Dialog. A close function will be passed
   * as a paramater you can use to close the dialog.
   *
   * `onConfirm={(close) => close()}`
   */
  onConfirm: PropTypes.func,

  /**
   * Label of the confirm button.
   */
  confirmLabel: PropTypes.string,

  /**
   * When true, the cancel button is shown.
   */
  hasCancel: PropTypes.bool,

  /**
   * Function that will be called when the cancel button is clicked.
   * This closes the Dialog by default.
   *
   * `onCancel={(close) => close()}`
   */
  onCancel: PropTypes.func,

  /**
   * Label of the cancel button.
   */
  cancelLabel: PropTypes.string,

  /**
   * Width of the Dialog.
   */
  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),

  /**
   * Props that are passed to the dialog container.
   */
  containerProps: PropTypes.object
});

_defineProperty(CornerDialog, "defaultProps", {
  width: 392,
  intent: 'none',
  hasFooter: true,
  confirmLabel: 'Learn More',
  hasCancel: true,
  cancelLabel: 'Close',
  onCancel: function onCancel(close) {
    return close();
  },
  onConfirm: function onConfirm(close) {
    return close();
  }
});

export { CornerDialog as default };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb3JuZXItZGlhbG9nL3NyYy9Db3JuZXJEaWFsb2cuanMiXSwibmFtZXMiOlsiUmVhY3QiLCJQdXJlQ29tcG9uZW50IiwiUHJvcFR5cGVzIiwiY3NzIiwiVHJhbnNpdGlvbiIsIlBhbmUiLCJDYXJkIiwiUG9ydGFsIiwiUGFyYWdyYXBoIiwiSGVhZGluZyIsIkJ1dHRvbiIsIkljb25CdXR0b24iLCJhbmltYXRpb25FYXNpbmciLCJkZWNlbGVyYXRpb24iLCJhY2NlbGVyYXRpb24iLCJzcHJpbmciLCJBTklNQVRJT05fRFVSQVRJT04iLCJvcGVuQW5pbWF0aW9uIiwia2V5ZnJhbWVzIiwiZnJvbSIsInRyYW5zZm9ybSIsInRvIiwiY2xvc2VBbmltYXRpb24iLCJvcGFjaXR5IiwiYW5pbWF0aW9uU3R5bGVzIiwiYW5pbWF0aW9uIiwiQ29ybmVyRGlhbG9nIiwicHJvcHMiLCJzZXRTdGF0ZSIsImV4aXRpbmciLCJleGl0ZWQiLCJvbkNsb3NlQ29tcGxldGUiLCJvbkNhbmNlbCIsImhhbmRsZUNsb3NlIiwib25Db25maXJtIiwiY2hpbGRyZW4iLCJjbG9zZSIsInN0YXRlIiwiaXNTaG93biIsInByZXZQcm9wcyIsInRpdGxlIiwid2lkdGgiLCJpbnRlbnQiLCJoYXNGb290ZXIiLCJoYXNDYW5jZWwiLCJjYW5jZWxMYWJlbCIsImNvbmZpcm1MYWJlbCIsIm9uT3BlbkNvbXBsZXRlIiwiY29udGFpbmVyUHJvcHMiLCJoYW5kbGVFeGl0ZWQiLCJyZW5kZXJDaGlsZHJlbiIsImhhbmRsZUNvbmZpcm0iLCJoYW5kbGVDYW5jZWwiLCJvbmVPZlR5cGUiLCJub2RlIiwiZnVuYyIsImlzUmVxdWlyZWQiLCJvbmVPZiIsImJvb2wiLCJzdHJpbmciLCJudW1iZXIiLCJvYmplY3QiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUEsT0FBT0EsS0FBUCxJQUFnQkMsYUFBaEIsUUFBcUMsT0FBckM7QUFDQSxPQUFPQyxTQUFQLE1BQXNCLFlBQXRCO0FBQ0Es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QWlFakI7OztBQUdBVixFQUFBQSxXQUFXLEVBQUUzQyxTQUFTLENBQUN5RCxNQXBFTjs7QUFzRWpCOzs7QUFHQWxCLEVBQUFBLEtBQUssRUFBRXZDLFNBQVMsQ0FBQ21ELFNBQVYsQ0FBb0IsQ0FBQ25ELFNBQVMsQ0FBQ3lELE1BQVgsRUFBbUJ6RCxTQUFTLENBQUMwRCxNQUE3QixDQUFwQixDQXpFVTs7QUEyRWpCOzs7QUFHQVosRUFBQUEsY0FBYyxFQUFFOUMsU0FBUyxDQUFDMkQ7QUE5RVQsQzs7Z0JBREFuQyxZLGtCQWtGRztBQUNwQmUsRUFBQUEsS0FBSyxFQUFFLEdBRGE7QUFFcEJDLEVBQUFBLE1BQU0sRUFBRSxNQUZZO0FBR3BCQyxFQUFBQSxTQUFTLEVBQUUsSUFIUztBQUlwQkcsRUFBQUEsWUFBWSxFQUFFLFlBSk07QUFLcEJGLEVBQUFBLFNBQVMsRUFBRSxJQUxTO0FBTXBCQyxFQUFBQSxXQUFXLEVBQUUsT0FOTztBQU9wQmIsRUFBQUEsUUFBUSxFQUFFLGtCQUFBSSxLQUFLO0FBQUEsV0FBSUEsS0FBSyxFQUFUO0FBQUEsR0FQSztBQVFwQkYsRUFBQUEsU0FBUyxFQUFFLG1CQUFBRSxLQUFLO0FBQUEsV0FBSUEsS0FBSyxFQUFUO0FBQUE7QUFSSSxDOztTQWxGSFYsWSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBQdXJlQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnXG5pbXBvcnQgeyBjc3MgfSBmcm9tICd1aS1ib3gnXG5pbXBvcnQgVHJhbnNpdGlvbiBmcm9tICdyZWFjdC10cmFuc2l0aW9uLWdyb3VwL1RyYW5zaXRpb24nXG5pbXBvcnQgeyBQYW5lLCBDYXJkIH0gZnJvbSAnLi4vLi4vbGF5ZXJzJ1xuaW1wb3J0IHsgUG9ydGFsIH0gZnJvbSAnLi4vLi4vcG9ydGFsJ1xuaW1wb3J0IHsgUGFyYWdyYXBoLCBIZWFkaW5nIH0gZnJvbSAnLi4vLi4vdHlwb2dyYXBoeSdcbmltcG9ydCB7IEJ1dHRvbiwgSWNvbkJ1dHRvbiB9IGZyb20gJy4uLy4uL2J1dHRvbnMnXG5cbmNvbnN0IGFuaW1hdGlvbkVhc2luZyA9IHtcbiAgZGVjZWxlcmF0aW9uOiBgY3ViaWMtYmV6aWVyKDAuMCwgMC4wLCAwLjIsIDEpYCxcbiAgYWNjZWxlcmF0aW9uOiBgY3ViaWMtYmV6aWVyKDAuNCwgMC4wLCAxLCAxKWAsXG4gIHNwcmluZzogYGN1YmljLWJlemllcigwLjE3NSwgMC44ODUsIDAuMzIwLCAxLjE3NSlgXG59XG5cbmNvbnN0IEFOSU1BVElPTl9EVVJBVElPTiA9IDI0MFxuXG5jb25zdCBvcGVuQW5pbWF0aW9uID0gY3NzLmtleWZyYW1lcygnb3BlbkFuaW1hdGlvbicsIHtcbiAgZnJvbToge1xuICAgIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoMTAwJSknXG4gIH0sXG4gIHRvOiB7XG4gICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgwKSdcbiAgfVxufSlcblxuY29uc3QgY2xvc2VBbmltYXRpb24gPSBjc3Mua2V5ZnJhbWVzKCdjbG9zZUFuaW1hdGlvbicsIHtcbiAgZnJvbToge1xuICAgIHRyYW5zZm9ybTogJ3NjYWxlKDEpJyxcbiAgICBvcGFjaXR5OiAxXG4gIH0sXG4gIHRvOiB7XG4gICAgdHJhbnNmb3JtOiAnc2NhbGUoMC45KScsXG4gICAgb3BhY2l0eTogMFxuICB9XG59KVxuXG5jb25zdCBhbmltYXRpb25TdHlsZXMgPSB7XG4gICcmW2RhdGEtc3RhdGU9XCJlbnRlcmluZ1wiXSwgJltkYXRhLXN0YXRlPVwiZW50ZXJlZFwiXSc6IHtcbiAgICBhbmltYXRpb246IGAke29wZW5BbmltYXRpb259ICR7QU5JTUFUSU9OX0RVUkFUSU9OfW1zICR7XG4gICAgICBhbmltYXRpb25FYXNpbmcuc3ByaW5nXG4gICAgfSBib3RoYFxuICB9LFxuICAnJltkYXRhLXN0YXRlPVwiZXhpdGluZ1wiXSc6IHtcbiAgICBhbmltYXRpb246IGAke2Nsb3NlQW5pbWF0aW9ufSAxMjBtcyAke2FuaW1hdGlvbkVhc2luZy5hY2NlbGVyYXRpb259IGJvdGhgXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29ybmVyRGlhbG9nIGV4dGVuZHMgUHVyZUNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgLyoqXG4gICAgICogQ2hpbGRyZW4gY2FuIGJlIGEgc3RyaW5nLCBub2RlIG9yIGEgZnVuY3Rpb24gYWNjZXB0aW5nIGAoeyBjbG9zZSB9KWAuXG4gICAgICogV2hlbiBwYXNzaW5nIGEgc3RyaW5nLCA8UGFyYWdyYXBoIHNpemU9ezQwMH0gY29sb3I9XCJtdXRlZFwiIC8+IGlzIHVzZWQgdG8gd3JhcCB0aGUgc3RyaW5nLlxuICAgICAqL1xuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMubm9kZSwgUHJvcFR5cGVzLmZ1bmNdKS5pc1JlcXVpcmVkLFxuXG4gICAgLyoqXG4gICAgICogVGhlIGludGVudCBvZiB0aGUgQ29ybmVyRGlhbG9nLiBVc2VkIGZvciB0aGUgYnV0dG9uLlxuICAgICAqL1xuICAgIGludGVudDogUHJvcFR5cGVzLm9uZU9mKFsnbm9uZScsICdzdWNjZXNzJywgJ3dhcm5pbmcnLCAnZGFuZ2VyJ10pXG4gICAgICAuaXNSZXF1aXJlZCxcblxuICAgIC8qKlxuICAgICAqIFdoZW4gdHJ1ZSwgdGhlIGRpYWxvZyBpcyBzaG93bi5cbiAgICAgKi9cbiAgICBpc1Nob3duOiBQcm9wVHlwZXMuYm9vbCxcblxuICAgIC8qKlxuICAgICAqIFRpdGxlIG9mIHRoZSBEaWFsb2cuIFRpdGxlcyBzaG91bGQgdXNlIFRpdGxlIENhc2UuXG4gICAgICovXG4gICAgdGl0bGU6IFByb3BUeXBlcy5ub2RlLFxuXG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBleGl0IHRyYW5zaXRpb24gaXMgY29tcGxldGUuXG4gICAgICovXG4gICAgb25DbG9zZUNvbXBsZXRlOiBQcm9wVHlwZXMuZnVuYyxcblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgZW50ZXIgdHJhbnNpdGlvbiBpcyBjb21wbGV0ZS5cbiAgICAgKi9cbiAgICBvbk9wZW5Db21wbGV0ZTogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgICAvKipcbiAgICAgKiBXaGVuIHRydWUsIHRoZSBmb290ZXIgd2l0aCB0aGUgY2FuY2VsIGFuZCBjb25maXJtIGJ1dHRvbiBpcyBzaG93bi5cbiAgICAgKi9cbiAgICBoYXNGb290ZXI6IFByb3BUeXBlcy5ib29sLFxuXG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBjb25maXJtIGJ1dHRvbiBpcyBjbGlja2VkLlxuICAgICAqIFRoaXMgZG9lcyBub3QgY2xvc2UgdGhlIERpYWxvZy4gQSBjbG9zZSBmdW5jdGlvbiB3aWxsIGJlIHBhc3NlZFxuICAgICAqIGFzIGEgcGFyYW1hdGVyIHlvdSBjYW4gdXNlIHRvIGNsb3NlIHRoZSBkaWFsb2cuXG4gICAgICpcbiAgICAgKiBgb25Db25maXJtPXsoY2xvc2UpID0+IGNsb3NlKCl9YFxuICAgICAqL1xuICAgIG9uQ29uZmlybTogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgICAvKipcbiAgICAgKiBMYWJlbCBvZiB0aGUgY29uZmlybSBidXR0b24uXG4gICAgICovXG4gICAgY29uZmlybUxhYmVsOiBQcm9wVHlwZXMuc3RyaW5nLFxuXG4gICAgLyoqXG4gICAgICogV2hlbiB0cnVlLCB0aGUgY2FuY2VsIGJ1dHRvbiBpcyBzaG93bi5cbiAgICAgKi9cbiAgICBoYXNDYW5jZWw6IFByb3BUeXBlcy5ib29sLFxuXG4gICAgLyoqXG4gICAgICogRnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBjYW5jZWwgYnV0dG9uIGlzIGNsaWNrZWQuXG4gICAgICogVGhpcyBjbG9zZXMgdGhlIERpYWxvZyBieSBkZWZhdWx0LlxuICAgICAqXG4gICAgICogYG9uQ2FuY2VsPXsoY2xvc2UpID0+IGNsb3NlKCl9YFxuICAgICAqL1xuICAgIG9uQ2FuY2VsOiBQcm9wVHlwZXMuZnVuYyxcblxuICAgIC8qKlxuICAgICAqIExhYmVsIG9mIHRoZSBjYW5jZWwgYnV0dG9uLlxuICAgICAqL1xuICAgIGNhbmNlbExhYmVsOiBQcm9wVHlwZXMuc3RyaW5nLFxuXG4gICAgLyoqXG4gICAgICogV2lkdGggb2YgdGhlIERpYWxvZy5cbiAgICAgKi9cbiAgICB3aWR0aDogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLm51bWJlcl0pLFxuXG4gICAgLyoqXG4gICAgICogUHJvcHMgdGhhdCBhcmUgcGFzc2VkIHRvIHRoZSBkaWFsb2cgY29udGFpbmVyLlxuICAgICAqL1xuICAgIGNvbnRhaW5lclByb3BzOiBQcm9wVHlwZXMub2JqZWN0XG4gIH1cblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIHdpZHRoOiAzOTIsXG4gICAgaW50ZW50OiAnbm9uZScsXG4gICAgaGFzRm9vdGVyOiB0cnVlLFxuICAgIGNvbmZpcm1MYWJlbDogJ0xlYXJuIE1vcmUnLFxuICAgIGhhc0NhbmNlbDogdHJ1ZSxcbiAgICBjYW5jZWxMYWJlbDogJ0Nsb3NlJyxcbiAgICBvbkNhbmNlbDogY2xvc2UgPT4gY2xvc2UoKSxcbiAgICBvbkNvbmZpcm06IGNsb3NlID0+IGNsb3NlKClcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpXG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgZXhpdGluZzogZmFsc2UsXG4gICAgICBleGl0ZWQ6ICFwcm9wcy5pc1Nob3duXG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcykge1xuICAgIGlmICghcHJldlByb3BzLmlzU2hvd24gJiYgdGhpcy5wcm9wcy5pc1Nob3duKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3Qvbm8tZGlkLXVwZGF0ZS1zZXQtc3RhdGVcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBleGl0ZWQ6IGZhbHNlXG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIGhhbmRsZUV4aXRlZCA9ICgpID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHsgZXhpdGluZzogZmFsc2UsIGV4aXRlZDogdHJ1ZSB9KVxuICAgIHRoaXMucHJvcHMub25DbG9zZUNvbXBsZXRlKClcbiAgfVxuXG4gIGhhbmRsZUNhbmNlbCA9ICgpID0+IHtcbiAgICB0aGlzLnByb3BzLm9uQ2FuY2VsKHRoaXMuaGFuZGxlQ2xvc2UpXG4gIH1cblxuICBoYW5kbGVDbG9zZSA9ICgpID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHsgZXhpdGluZzogdHJ1ZSB9KVxuICB9XG5cbiAgaGFuZGxlQ29uZmlybSA9ICgpID0+IHtcbiAgICB0aGlzLnByb3BzLm9uQ29uZmlybSh0aGlzLmhhbmRsZUNsb3NlKVxuICB9XG5cbiAgcmVuZGVyQ2hpbGRyZW4gPSAoKSA9PiB7XG4gICAgY29uc3QgeyBjaGlsZHJlbiB9ID0gdGhpcy5wcm9wc1xuICAgIGlmICh0eXBlb2YgY2hpbGRyZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBjaGlsZHJlbih7IGNsb3NlOiB0aGlzLmhhbmRsZUNsb3NlIH0pXG4gICAgfVxuICAgIGlmICh0eXBlb2YgY2hpbGRyZW4gPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8UGFyYWdyYXBoIHNpemU9ezQwMH0gY29sb3I9XCJtdXRlZFwiPlxuICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgPC9QYXJhZ3JhcGg+XG4gICAgICApXG4gICAgfVxuICAgIHJldHVybiBjaGlsZHJlblxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHRpdGxlLFxuICAgICAgd2lkdGgsXG4gICAgICBpbnRlbnQsXG4gICAgICBpc1Nob3duLFxuICAgICAgaGFzRm9vdGVyLFxuICAgICAgaGFzQ2FuY2VsLFxuICAgICAgY2FuY2VsTGFiZWwsXG4gICAgICBjb25maXJtTGFiZWwsXG4gICAgICBvbk9wZW5Db21wbGV0ZSxcbiAgICAgIGNvbnRhaW5lclByb3BzXG4gICAgfSA9IHRoaXMucHJvcHNcblxuICAgIGNvbnN0IHsgZXhpdGluZywgZXhpdGVkIH0gPSB0aGlzLnN0YXRlXG5cbiAgICBpZiAoZXhpdGVkKSByZXR1cm4gbnVsbFxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxQb3J0YWw+XG4gICAgICAgIDxUcmFuc2l0aW9uXG4gICAgICAgICAgYXBwZWFyXG4gICAgICAgICAgdW5tb3VudE9uRXhpdFxuICAgICAgICAgIHRpbWVvdXQ9e0FOSU1BVElPTl9EVVJBVElPTn1cbiAgICAgICAgICBpbj17aXNTaG93biAmJiAhZXhpdGluZ31cbiAgICAgICAgICBvbkV4aXRlZD17dGhpcy5oYW5kbGVFeGl0ZWR9XG4gICAgICAgICAgb25FbnRlcmVkPXtvbk9wZW5Db21wbGV0ZX1cbiAgICAgICAgPlxuICAgICAgICAgIHtzdGF0ZSA9PiAoXG4gICAgICAgICAgICA8Q2FyZFxuICAgICAgICAgICAgICByb2xlPVwiZGlhbG9nXCJcbiAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yPVwid2hpdGVcIlxuICAgICAgICAgICAgICBlbGV2YXRpb249ezR9XG4gICAgICAgICAgICAgIHdpZHRoPXt3aWR0aH1cbiAgICAgICAgICAgICAgY3NzPXthbmltYXRpb25TdHlsZXN9XG4gICAgICAgICAgICAgIGRhdGEtc3RhdGU9e3N0YXRlfVxuICAgICAgICAgICAgICBwb3NpdGlvbj1cImZpeGVkXCJcbiAgICAgICAgICAgICAgYm90dG9tPXsxNn1cbiAgICAgICAgICAgICAgcmlnaHQ9ezE2fVxuICAgICAgICAgICAgICBwYWRkaW5nPXszMn1cbiAgICAgICAgICAgICAgey4uLmNvbnRhaW5lclByb3BzfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8UGFuZSBkaXNwbGF5PVwiZmxleFwiIGFsaWduSXRlbXM9XCJjZW50ZXJcIiBtYXJnaW5Cb3R0b209ezEyfT5cbiAgICAgICAgICAgICAgICA8SGVhZGluZyBpcz1cImg0XCIgc2l6ZT17NjAwfSBmbGV4PVwiMVwiPlxuICAgICAgICAgICAgICAgICAge3RpdGxlfVxuICAgICAgICAgICAgICAgIDwvSGVhZGluZz5cbiAgICAgICAgICAgICAgICA8SWNvbkJ1dHRvblxuICAgICAgICAgICAgICAgICAgaGVpZ2h0PXszMn1cbiAgICAgICAgICAgICAgICAgIGljb249XCJjcm9zc1wiXG4gICAgICAgICAgICAgICAgICBhcHBlYXJhbmNlPVwibWluaW1hbFwiXG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLmhhbmRsZUNsb3NlfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvUGFuZT5cblxuICAgICAgICAgICAgICA8UGFuZSBvdmVyZmxvd1k9XCJhdXRvXCIgZGF0YS1zdGF0ZT17c3RhdGV9PlxuICAgICAgICAgICAgICAgIHt0aGlzLnJlbmRlckNoaWxkcmVuKCl9XG4gICAgICAgICAgICAgIDwvUGFuZT5cblxuICAgICAgICAgICAgICB7aGFzRm9vdGVyICYmIChcbiAgICAgICAgICAgICAgICA8UGFuZVxuICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wPXsyNH1cbiAgICAgICAgICAgICAgICAgIGZsZXhTaHJpbms9ezB9XG4gICAgICAgICAgICAgICAgICBkaXNwbGF5PVwiZmxleFwiXG4gICAgICAgICAgICAgICAgICBmbGV4RGlyZWN0aW9uPVwicm93LXJldmVyc2VcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgYXBwZWFyYW5jZT1cInByaW1hcnlcIlxuICAgICAgICAgICAgICAgICAgICBpbnRlbnQ9e2ludGVudH1cbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luTGVmdD17OH1cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5oYW5kbGVDb25maXJtfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICB7Y29uZmlybUxhYmVsfVxuICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgICAgICAgICB7aGFzQ2FuY2VsICYmIChcbiAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBvbkNsaWNrPXt0aGlzLmhhbmRsZUNhbmNlbH0+e2NhbmNlbExhYmVsfTwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA8L1BhbmU+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L0NhcmQ+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9UcmFuc2l0aW9uPlxuICAgICAgPC9Qb3J0YWw+XG4gICAgKVxuICB9XG59XG4iXX0=