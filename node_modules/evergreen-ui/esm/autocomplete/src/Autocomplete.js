import _extends from "@babel/runtime/helpers/esm/extends";
import _objectSpread from "@babel/runtime/helpers/esm/objectSpread";
import _objectWithoutProperties from "@babel/runtime/helpers/esm/objectWithoutProperties";
import _classCallCheck from "@babel/runtime/helpers/esm/classCallCheck";
import _createClass from "@babel/runtime/helpers/esm/createClass";
import _possibleConstructorReturn from "@babel/runtime/helpers/esm/possibleConstructorReturn";
import _getPrototypeOf from "@babel/runtime/helpers/esm/getPrototypeOf";
import _inherits from "@babel/runtime/helpers/esm/inherits";
import _assertThisInitialized from "@babel/runtime/helpers/esm/assertThisInitialized";
import _defineProperty from "@babel/runtime/helpers/esm/defineProperty";
import React, { PureComponent } from 'react';
import PropTypes from 'prop-types';
import fuzzaldrin from 'fuzzaldrin-plus';
import Downshift from 'downshift';
import VirtualList from 'react-tiny-virtual-list';
import { Popover } from '../../popover';
import { Position } from '../../constants';
import { Heading } from '../../typography';
import { Pane } from '../../layers';
import AutocompleteItem from './AutocompleteItem';

var fuzzyFilter = function fuzzyFilter(items, input) {
  return fuzzaldrin.filter(items, input);
};

var autocompleteItemRenderer = function autocompleteItemRenderer(props) {
  return React.createElement(AutocompleteItem, props);
};

autocompleteItemRenderer.displayName = "autocompleteItemRenderer";

// https://github.com/paypal/downshift/issues/164
var Autocomplete =
/*#__PURE__*/
function (_PureComponent) {
  _inherits(Autocomplete, _PureComponent);

  function Autocomplete() {
    var _getPrototypeOf2;

    var _this;

    _classCallCheck(this, Autocomplete);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Autocomplete)).call.apply(_getPrototypeOf2, [this].concat(args)));

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "state", {
      targetWidth: 0
    });

    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), "renderResults", function (_ref) {
      var width = _ref.width,
          inputValue = _ref.inputValue,
          highlightedIndex = _ref.highlightedIndex,
          selectItemAtIndex = _ref.selectItemAtIndex,
          selectedItem = _ref.selectedItem,
          getItemProps = _ref.getItemProps;
      var _this$props = _this.props,
          title = _this$props.title,
          itemSize = _this$props.itemSize,
          itemsFilter = _this$props.itemsFilter,
          originalItems = _this$props.items,
          itemToString = _this$props.itemToString,
          _renderItem = _this$props.renderItem,
          popoverMaxHeight = _this$props.popoverMaxHeight,
          isFilterDisabled = _this$props.isFilterDisabled;
      var items = isFilterDisabled || inputValue.trim() === '' ? originalItems : itemsFilter(originalItems, inputValue);
      if (items.length === 0) return null;
      return React.createElement(Pane, {
        width: width
      }, title && React.createElement(Pane, {
        padding: 8,
        borderBottom: "muted"
      }, React.createElement(Heading, {
        size: 100
      }, title)), items.length > 0 && React.createElement(VirtualList, {
        width: "100%",
        height: Math.min(items.length * itemSize, popoverMaxHeight),
        itemSize: itemSize,
        itemCount: items.length,
        scrollToIndex: highlightedIndex || 0,
        overscanCount: 3,
        scrollToAlignment: "auto",
        renderItem: function renderItem(_ref2) {
          var index = _ref2.index,
              style = _ref2.style;
          var item = items[index];
          var itemString = itemToString(item);
          return _renderItem(getItemProps({
            item: item,
            key: itemString,
            index: index,
            style: style,
            children: itemString,
            onMouseUp: function onMouseUp() {
              selectItemAtIndex(index);
            },
            isSelected: itemToString(selectedItem) === itemString,
            isHighlighted: highlightedIndex === index
          }));
        }
      }));
    });

    return _this;
  }

  _createClass(Autocomplete, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this.setState({
        targetWidth: this.targetRef.getBoundingClientRect().width
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props2 = this.props,
          children = _this$props2.children,
          itemSize = _this$props2.itemSize,
          position = _this$props2.position,
          renderItem = _this$props2.renderItem,
          itemsFilter = _this$props2.itemsFilter,
          popoverMaxHeight = _this$props2.popoverMaxHeight,
          popoverMinWidth = _this$props2.popoverMinWidth,
          defaultSelectedItem = _this$props2.defaultSelectedItem,
          props = _objectWithoutProperties(_this$props2, ["children", "itemSize", "position", "renderItem", "itemsFilter", "popoverMaxHeight", "popoverMinWidth", "defaultSelectedItem"]);

      return React.createElement(Downshift, _extends({
        defaultSelectedItem: defaultSelectedItem
      }, props), function (_ref3) {
        var isShown = _ref3.isOpen,
            inputValue = _ref3.inputValue,
            getItemProps = _ref3.getItemProps,
            selectedItem = _ref3.selectedItem,
            highlightedIndex = _ref3.highlightedIndex,
            selectItemAtIndex = _ref3.selectItemAtIndex,
            getRootProps = _ref3.getRootProps,
            restDownshiftProps = _objectWithoutProperties(_ref3, ["isOpen", "inputValue", "getItemProps", "selectedItem", "highlightedIndex", "selectItemAtIndex", "getRootProps"]);

        return React.createElement(Pane, _extends({
          width: "100%"
        }, getRootProps({
          refKey: 'innerRef'
        })), React.createElement(Popover, {
          bringFocusInside: false,
          isShown: isShown,
          minWidth: popoverMinWidth,
          position: position || (_this2.state.targetWidth < popoverMinWidth ? Position.BOTTOM_LEFT : Position.BOTTOM),
          content: function content() {
            return _this2.renderResults({
              width: Math.max(_this2.state.targetWidth, popoverMinWidth),
              inputValue: inputValue,
              getItemProps: getItemProps,
              selectedItem: selectedItem,
              highlightedIndex: highlightedIndex,
              selectItemAtIndex: selectItemAtIndex
            });
          },
          minHeight: 0,
          animationDuration: 0
        }, function (_ref4) {
          var isShownPopover = _ref4.isShown,
              toggle = _ref4.toggle,
              _getRef = _ref4.getRef;
          return children(_objectSpread({
            isShown: isShownPopover,
            toggle: toggle,
            getRef: function getRef(ref) {
              // Use the ref internally to determine the width
              _this2.targetRef = ref;

              _getRef(ref);
            },
            inputValue: inputValue,
            selectedItem: selectedItem,
            highlightedIndex: highlightedIndex,
            selectItemAtIndex: selectItemAtIndex
          }, restDownshiftProps));
        }));
      });
    }
  }]);

  return Autocomplete;
}(PureComponent);

Autocomplete.displayName = "Autocomplete";

_defineProperty(Autocomplete, "propTypes", _objectSpread({
  /**
   * This prop can be either a string or a Node.
   * It will provide a title for the items
   */
  title: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),

  /**
   * An array of items to be used as options for the select
   */
  items: PropTypes.array.isRequired,

  /**
   * The selected Item to be shown on the autocomplete
   */
  selectedItem: PropTypes.any,

  /**
   * The selected item to be selected & shown by default on the autocomplete
   */
  defaultSelectedItem: PropTypes.any,

  /**
   * In case the array of items is not an array of strings,
   * this function is used on each item to return the string that will be shown on the filter
   */
  itemToString: PropTypes.func.isRequired,

  /**
   * Function that will render the 'filter' component.
   */
  children: PropTypes.func.isRequired,

  /**
   * The height of each item in the list
   * Because the list is virtualized this is required beforehand.
   */
  itemSize: PropTypes.number,

  /**
   * Function that returns a component to render the item
   */
  renderItem: PropTypes.func,

  /**
   * The position of the Popover the Autocomplete is rendered in.
   */
  position: PropTypes.oneOf(Object.keys(Position)),

  /**
   * A function that is used to filter the items.
   * It should return a subset of the initial items.
   * By default the "fuzzaldrin-plus" package is used.
   */
  itemsFilter: PropTypes.func,

  /**
   * Prop that enables and disables filtering
   * True: Enables Filtering
   * False: Disables Filtering
   */
  isFilterDisabled: PropTypes.bool,

  /**
   * Defines the minimum height the results container will be
   */
  popoverMinWidth: PropTypes.number,

  /**
   * Defines the maximum height the results container will be
   */
  popoverMaxHeight: PropTypes.number
}, Downshift.propTypes));

_defineProperty(Autocomplete, "defaultProps", {
  itemToString: function itemToString(i) {
    return i ? String(i) : '';
  },
  itemSize: 32,
  itemsFilter: fuzzyFilter,
  isFilterDisabled: false,
  popoverMinWidth: 240,
  popoverMaxHeight: 240,
  renderItem: autocompleteItemRenderer
});

export { Autocomplete as default };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hdXRvY29tcGxldGUvc3JjL0F1dG9jb21wbGV0ZS5qcyJdLCJuYW1lcyI6WyJSZWFjdCIsIlB1cmVDb21wb25lbnQiLCJQcm9wVHlwZXMiLCJmdXp6YWxkcmluIiwiRG93bnNoaWZ0IiwiVmlydHVhbExpc3QiLCJQb3BvdmVyIiwiUG9zaXRpb24iLCJIZWFkaW5nIiwiUGFuZSIsIkF1dG9jb21wbGV0ZUl0ZW0iLCJmdXp6eUZpbHRlciIsIml0ZW1zIiwiaW5wdXQiLCJmaWx0ZXIiLCJhdXRvY29tcGxldGVJdGVtUmVuZGVyZXIiLCJwcm9wcyIsIkF1dG9jb21wbGV0ZSIsInRhcmdldFdpZHRoIiwid2lkdGgiLCJpbnB1dFZhbHVlIiwiaGlnaGxpZ2h0ZWRJbmRleCIsInNlbGVjdEl0ZW1BdEluZGV4Iiwic2VsZWN0ZWRJdGVtIiwiZ2V0SXRlbVByb3BzIiwidGl0bGUiLCJpdGVtU2l6ZSIsIml0ZW1zRmlsdGVyIiwib3JpZ2luYWxJdGVtcyIsIml0ZW1Ub1N0cmluZyIsInJlbmRlckl0ZW0iLCJwb3BvdmVyTWF4SGVpZ2h0IiwiaXNGaWx0ZXJEaXNhYmxlZCIsInRyaW0iLCJsZW5ndGgiLCJNYXRoIiwibWluIiwiaW5kZXgiLCJzdHlsZSIsIml0ZW0iLCJpdGVtU3RyaW5nIiwia2V5IiwiY2hpbGRyZW4iLCJvbk1vdXNlVXAiLCJpc1NlbGVjdGVkIiwiaXNIaWdobGlnaHRlZCIsInNldFN0YXRlIiwidGFyZ2V0UmVmIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwicG9zaXRpb24iLCJwb3BvdmVyTWluV2lkdGgiLCJkZWZhdWx0U2VsZWN0ZWRJdGVtIiwiaXNTaG93biIsImlzT3BlbiIsImdldFJvb3RQcm9wcyIsInJlc3REb3duc2hpZnRQcm9wcyIsInJlZktleSIsInN0YXRlIiwiQk9UVE9NX0xFRlQiLCJCT1RUT00iLCJyZW5kZXJSZXN1bHRzIiwibWF4IiwiaXNTaG93blBvcG92ZXIiLCJ0b2dnbGUiLCJnZXRSZWYiLCJyZWYiLCJvbmVPZlR5cGUiLCJzdHJpbmciLCJub2RlIiwiYXJyYXkiLCJpc1JlcXVpcmVkIiwiYW55IiwiZnVuYyIsIm51bWJlciIsIm9uZU9mIiwiT2JqZWN0Iiwia2V5cyIsImJvb2wiLCJwcm9wVHlwZXMiLCJpIiwiU3RyaW5nIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsT0FBT0EsS0FBUCxJQUFnQkMsYUFBaEIsUUFBcUMsT0FBckM7QUFDQSxPQUFPQyxTQUFQLE1BQXNCLFlBQXRCO0FBQ0EsT0FBT0MsVUFBUCxNQUF1QixpQkFBdkI7QUFDQSxPQUFPQyxTQUFQLE1BQXNCLFdBQXRCO0FBQ0EsT0FBT0MsV0FBUCxNQUF3Qix5QkFBeEI7QUFDQSxTQUFTQyxPQUFULFFBQXdCLGVBQXhCO0FBQ0EsU0FBU0MsUUFBVCxRQUF5QixpQkFBekI7QUFDQSxTQUFTQyxPQUFULFFBQXdCLGtCQUF4QjtBQUNBLFNBQVNDLElBQVQsUUFBcUIsY0FBckI7QUFDQSxPQUFPQyxnQkFBUCxNQUE2QixvQkFBN0I7O0FBRUEsSUFBTUMsV0FBVyxHQUFHLFNBQWRBLFdBQWMsQ0FBQ0MsS0FBRCxFQUFRQyxLQUFSO0FBQUEsU0FBa0JWLFVBQVUsQ0FBQ1csTUFBWCxDQUFrQkYsS0FBbEIsRUFBeUJDLEtBQXpCLENBQWxCO0FBQUEsQ0FBcEI7O0FBRUEsSUFBTUUsd0JBQXdCLEdBQUcsU0FBM0JBLHdCQUEyQixDQUFBQyxLQUFLO0FBQUEsU0FBSSxvQkFBQyxnQkFBRCxFQUFzQkEsS0FBdEIsQ0FBSjtBQUFBLENBQXRDOztBQUFNRCx3Qjs7QUFFTjtJQUNxQkUsWTs7Ozs7Ozs7Ozs7Ozs7Ozs7O29GQTZFWDtBQUNOQyxNQUFBQSxXQUFXLEVBQUU7QUFEUCxLOzs0RkFvQlEsZ0JBT1Y7QUFBQSxVQU5KQyxLQU1JLFFBTkpBLEtBTUk7QUFBQSxVQUxKQyxVQUtJLFFBTEpBLFVBS0k7QUFBQSxVQUpKQyxnQkFJSSxRQUpKQSxnQkFJSTtBQUFBLFVBSEpDLGlCQUdJLFFBSEpBLGlCQUdJO0FBQUEsVUFGSkMsWUFFSSxRQUZK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QUFnQixFQUFFLEdBTkU7QUFPcEJELEVBQUFBLFVBQVUsRUFBRWY7QUFQUSxDOztTQWpGSEUsWSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBQdXJlQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnXG5pbXBvcnQgZnV6emFsZHJpbiBmcm9tICdmdXp6YWxkcmluLXBsdXMnXG5pbXBvcnQgRG93bnNoaWZ0IGZyb20gJ2Rvd25zaGlmdCdcbmltcG9ydCBWaXJ0dWFsTGlzdCBmcm9tICdyZWFjdC10aW55LXZpcnR1YWwtbGlzdCdcbmltcG9ydCB7IFBvcG92ZXIgfSBmcm9tICcuLi8uLi9wb3BvdmVyJ1xuaW1wb3J0IHsgUG9zaXRpb24gfSBmcm9tICcuLi8uLi9jb25zdGFudHMnXG5pbXBvcnQgeyBIZWFkaW5nIH0gZnJvbSAnLi4vLi4vdHlwb2dyYXBoeSdcbmltcG9ydCB7IFBhbmUgfSBmcm9tICcuLi8uLi9sYXllcnMnXG5pbXBvcnQgQXV0b2NvbXBsZXRlSXRlbSBmcm9tICcuL0F1dG9jb21wbGV0ZUl0ZW0nXG5cbmNvbnN0IGZ1enp5RmlsdGVyID0gKGl0ZW1zLCBpbnB1dCkgPT4gZnV6emFsZHJpbi5maWx0ZXIoaXRlbXMsIGlucHV0KVxuXG5jb25zdCBhdXRvY29tcGxldGVJdGVtUmVuZGVyZXIgPSBwcm9wcyA9PiA8QXV0b2NvbXBsZXRlSXRlbSB7Li4ucHJvcHN9IC8+XG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wYXlwYWwvZG93bnNoaWZ0L2lzc3Vlcy8xNjRcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEF1dG9jb21wbGV0ZSBleHRlbmRzIFB1cmVDb21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIC8qKlxuICAgICAqIFRoaXMgcHJvcCBjYW4gYmUgZWl0aGVyIGEgc3RyaW5nIG9yIGEgTm9kZS5cbiAgICAgKiBJdCB3aWxsIHByb3ZpZGUgYSB0aXRsZSBmb3IgdGhlIGl0ZW1zXG4gICAgICovXG4gICAgdGl0bGU6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5zdHJpbmcsIFByb3BUeXBlcy5ub2RlXSksXG5cbiAgICAvKipcbiAgICAgKiBBbiBhcnJheSBvZiBpdGVtcyB0byBiZSB1c2VkIGFzIG9wdGlvbnMgZm9yIHRoZSBzZWxlY3RcbiAgICAgKi9cbiAgICBpdGVtczogUHJvcFR5cGVzLmFycmF5LmlzUmVxdWlyZWQsXG5cbiAgICAvKipcbiAgICAgKiBUaGUgc2VsZWN0ZWQgSXRlbSB0byBiZSBzaG93biBvbiB0aGUgYXV0b2NvbXBsZXRlXG4gICAgICovXG4gICAgc2VsZWN0ZWRJdGVtOiBQcm9wVHlwZXMuYW55LFxuXG4gICAgLyoqXG4gICAgICogVGhlIHNlbGVjdGVkIGl0ZW0gdG8gYmUgc2VsZWN0ZWQgJiBzaG93biBieSBkZWZhdWx0IG9uIHRoZSBhdXRvY29tcGxldGVcbiAgICAgKi9cbiAgICBkZWZhdWx0U2VsZWN0ZWRJdGVtOiBQcm9wVHlwZXMuYW55LFxuXG4gICAgLyoqXG4gICAgICogSW4gY2FzZSB0aGUgYXJyYXkgb2YgaXRlbXMgaXMgbm90IGFuIGFycmF5IG9mIHN0cmluZ3MsXG4gICAgICogdGhpcyBmdW5jdGlvbiBpcyB1c2VkIG9uIGVhY2ggaXRlbSB0byByZXR1cm4gdGhlIHN0cmluZyB0aGF0IHdpbGwgYmUgc2hvd24gb24gdGhlIGZpbHRlclxuICAgICAqL1xuICAgIGl0ZW1Ub1N0cmluZzogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcblxuICAgIC8qKlxuICAgICAqIEZ1bmN0aW9uIHRoYXQgd2lsbCByZW5kZXIgdGhlICdmaWx0ZXInIGNvbXBvbmVudC5cbiAgICAgKi9cbiAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcblxuICAgIC8qKlxuICAgICAqIFRoZSBoZWlnaHQgb2YgZWFjaCBpdGVtIGluIHRoZSBsaXN0XG4gICAgICogQmVjYXVzZSB0aGUgbGlzdCBpcyB2aXJ0dWFsaXplZCB0aGlzIGlzIHJlcXVpcmVkIGJlZm9yZWhhbmQuXG4gICAgICovXG4gICAgaXRlbVNpemU6IFByb3BUeXBlcy5udW1iZXIsXG5cbiAgICAvKipcbiAgICAgKiBGdW5jdGlvbiB0aGF0IHJldHVybnMgYSBjb21wb25lbnQgdG8gcmVuZGVyIHRoZSBpdGVtXG4gICAgICovXG4gICAgcmVuZGVySXRlbTogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgICAvKipcbiAgICAgKiBUaGUgcG9zaXRpb24gb2YgdGhlIFBvcG92ZXIgdGhlIEF1dG9jb21wbGV0ZSBpcyByZW5kZXJlZCBpbi5cbiAgICAgKi9cbiAgICBwb3NpdGlvbjogUHJvcFR5cGVzLm9uZU9mKE9iamVjdC5rZXlzKFBvc2l0aW9uKSksXG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHRoYXQgaXMgdXNlZCB0byBmaWx0ZXIgdGhlIGl0ZW1zLlxuICAgICAqIEl0IHNob3VsZCByZXR1cm4gYSBzdWJzZXQgb2YgdGhlIGluaXRpYWwgaXRlbXMuXG4gICAgICogQnkgZGVmYXVsdCB0aGUgXCJmdXp6YWxkcmluLXBsdXNcIiBwYWNrYWdlIGlzIHVzZWQuXG4gICAgICovXG4gICAgaXRlbXNGaWx0ZXI6IFByb3BUeXBlcy5mdW5jLFxuXG4gICAgLyoqXG4gICAgICogUHJvcCB0aGF0IGVuYWJsZXMgYW5kIGRpc2FibGVzIGZpbHRlcmluZ1xuICAgICAqIFRydWU6IEVuYWJsZXMgRmlsdGVyaW5nXG4gICAgICogRmFsc2U6IERpc2FibGVzIEZpbHRlcmluZ1xuICAgICAqL1xuICAgIGlzRmlsdGVyRGlzYWJsZWQ6IFByb3BUeXBlcy5ib29sLFxuXG4gICAgLyoqXG4gICAgICogRGVmaW5lcyB0aGUgbWluaW11bSBoZWlnaHQgdGhlIHJlc3VsdHMgY29udGFpbmVyIHdpbGwgYmVcbiAgICAgKi9cbiAgICBwb3BvdmVyTWluV2lkdGg6IFByb3BUeXBlcy5udW1iZXIsXG5cbiAgICAvKipcbiAgICAgKiBEZWZpbmVzIHRoZSBtYXhpbXVtIGhlaWdodCB0aGUgcmVzdWx0cyBjb250YWluZXIgd2lsbCBiZVxuICAgICAqL1xuICAgIHBvcG92ZXJNYXhIZWlnaHQ6IFByb3BUeXBlcy5udW1iZXIsXG5cbiAgICAuLi5Eb3duc2hpZnQucHJvcFR5cGVzXG4gIH1cblxuICBzdGF0ZSA9IHtcbiAgICB0YXJnZXRXaWR0aDogMFxuICB9XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBpdGVtVG9TdHJpbmc6IGkgPT4gKGkgPyBTdHJpbmcoaSkgOiAnJyksXG4gICAgaXRlbVNpemU6IDMyLFxuICAgIGl0ZW1zRmlsdGVyOiBmdXp6eUZpbHRlcixcbiAgICBpc0ZpbHRlckRpc2FibGVkOiBmYWxzZSxcbiAgICBwb3BvdmVyTWluV2lkdGg6IDI0MCxcbiAgICBwb3BvdmVyTWF4SGVpZ2h0OiAyNDAsXG4gICAgcmVuZGVySXRlbTogYXV0b2NvbXBsZXRlSXRlbVJlbmRlcmVyXG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIHRhcmdldFdpZHRoOiB0aGlzLnRhcmdldFJlZi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aFxuICAgIH0pXG4gIH1cblxuICByZW5kZXJSZXN1bHRzID0gKHtcbiAgICB3aWR0aCxcbiAgICBpbnB1dFZhbHVlLFxuICAgIGhpZ2hsaWdodGVkSW5kZXgsXG4gICAgc2VsZWN0SXRlbUF0SW5kZXgsXG4gICAgc2VsZWN0ZWRJdGVtLFxuICAgIGdldEl0ZW1Qcm9wc1xuICB9KSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgdGl0bGUsXG4gICAgICBpdGVtU2l6ZSxcbiAgICAgIGl0ZW1zRmlsdGVyLFxuICAgICAgaXRlbXM6IG9yaWdpbmFsSXRlbXMsXG4gICAgICBpdGVtVG9TdHJpbmcsXG4gICAgICByZW5kZXJJdGVtLFxuICAgICAgcG9wb3Zlck1heEhlaWdodCxcbiAgICAgIGlzRmlsdGVyRGlzYWJsZWRcbiAgICB9ID0gdGhpcy5wcm9wc1xuXG4gICAgY29uc3QgaXRlbXMgPVxuICAgICAgaXNGaWx0ZXJEaXNhYmxlZCB8fCBpbnB1dFZhbHVlLnRyaW0oKSA9PT0gJydcbiAgICAgICAgPyBvcmlnaW5hbEl0ZW1zXG4gICAgICAgIDogaXRlbXNGaWx0ZXIob3JpZ2luYWxJdGVtcywgaW5wdXRWYWx1ZSlcblxuICAgIGlmIChpdGVtcy5sZW5ndGggPT09IDApIHJldHVybiBudWxsXG5cbiAgICByZXR1cm4gKFxuICAgICAgPFBhbmUgd2lkdGg9e3dpZHRofT5cbiAgICAgICAge3RpdGxlICYmIChcbiAgICAgICAgICA8UGFuZSBwYWRkaW5nPXs4fSBib3JkZXJCb3R0b209XCJtdXRlZFwiPlxuICAgICAgICAgICAgPEhlYWRpbmcgc2l6ZT17MTAwfT57dGl0bGV9PC9IZWFkaW5nPlxuICAgICAgICAgIDwvUGFuZT5cbiAgICAgICAgKX1cbiAgICAgICAge2l0ZW1zLmxlbmd0aCA+IDAgJiYgKFxuICAgICAgICAgIDxWaXJ0dWFsTGlzdFxuICAgICAgICAgICAgd2lkdGg9XCIxMDAlXCJcbiAgICAgICAgICAgIGhlaWdodD17TWF0aC5taW4oaXRlbXMubGVuZ3RoICogaXRlbVNpemUsIHBvcG92ZXJNYXhIZWlnaHQpfVxuICAgICAgICAgICAgaXRlbVNpemU9e2l0ZW1TaXplfVxuICAgICAgICAgICAgaXRlbUNvdW50PXtpdGVtcy5sZW5ndGh9XG4gICAgICAgICAgICBzY3JvbGxUb0luZGV4PXtoaWdobGlnaHRlZEluZGV4IHx8IDB9XG4gICAgICAgICAgICBvdmVyc2NhbkNvdW50PXszfVxuICAgICAgICAgICAgc2Nyb2xsVG9BbGlnbm1lbnQ9XCJhdXRvXCJcbiAgICAgICAgICAgIHJlbmRlckl0ZW09eyh7IGluZGV4LCBzdHlsZSB9KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBpdGVtc1tpbmRleF1cbiAgICAgICAgICAgICAgY29uc3QgaXRlbVN0cmluZyA9IGl0ZW1Ub1N0cmluZyhpdGVtKVxuICAgICAgICAgICAgICByZXR1cm4gcmVuZGVySXRlbShcbiAgICAgICAgICAgICAgICBnZXRJdGVtUHJvcHMoe1xuICAgICAgICAgICAgICAgICAgaXRlbSxcbiAgICAgICAgICAgICAgICAgIGtleTogaXRlbVN0cmluZyxcbiAgICAgICAgICAgICAgICAgIGluZGV4LFxuICAgICAgICAgICAgICAgICAgc3R5bGUsXG4gICAgICAgICAgICAgICAgICBjaGlsZHJlbjogaXRlbVN0cmluZyxcbiAgICAgICAgICAgICAgICAgIG9uTW91c2VVcDogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RJdGVtQXRJbmRleChpbmRleClcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBpc1NlbGVjdGVkOiBpdGVtVG9TdHJpbmcoc2VsZWN0ZWRJdGVtKSA9PT0gaXRlbVN0cmluZyxcbiAgICAgICAgICAgICAgICAgIGlzSGlnaGxpZ2h0ZWQ6IGhpZ2hsaWdodGVkSW5kZXggPT09IGluZGV4XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgPC9QYW5lPlxuICAgIClcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7XG4gICAgICBjaGlsZHJlbixcbiAgICAgIGl0ZW1TaXplLFxuICAgICAgcG9zaXRpb24sXG4gICAgICByZW5kZXJJdGVtLFxuICAgICAgaXRlbXNGaWx0ZXIsXG4gICAgICBwb3BvdmVyTWF4SGVpZ2h0LFxuICAgICAgcG9wb3Zlck1pbldpZHRoLFxuICAgICAgZGVmYXVsdFNlbGVjdGVkSXRlbSxcbiAgICAgIC4uLnByb3BzXG4gICAgfSA9IHRoaXMucHJvcHNcblxuICAgIHJldHVybiAoXG4gICAgICA8RG93bnNoaWZ0IGRlZmF1bHRTZWxlY3RlZEl0ZW09e2RlZmF1bHRTZWxlY3RlZEl0ZW19IHsuLi5wcm9wc30+XG4gICAgICAgIHsoe1xuICAgICAgICAgIGlzT3BlbjogaXNTaG93bixcbiAgICAgICAgICBpbnB1dFZhbHVlLFxuICAgICAgICAgIGdldEl0ZW1Qcm9wcyxcbiAgICAgICAgICBzZWxlY3RlZEl0ZW0sXG4gICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICBzZWxlY3RJdGVtQXRJbmRleCxcbiAgICAgICAgICBnZXRSb290UHJvcHMsXG4gICAgICAgICAgLi4ucmVzdERvd25zaGlmdFByb3BzXG4gICAgICAgIH0pID0+IChcbiAgICAgICAgICA8UGFuZSB3aWR0aD1cIjEwMCVcIiB7Li4uZ2V0Um9vdFByb3BzKHsgcmVmS2V5OiAnaW5uZXJSZWYnIH0pfT5cbiAgICAgICAgICAgIDxQb3BvdmVyXG4gICAgICAgICAgICAgIGJyaW5nRm9jdXNJbnNpZGU9e2ZhbHNlfVxuICAgICAgICAgICAgICBpc1Nob3duPXtpc1Nob3dufVxuICAgICAgICAgICAgICBtaW5XaWR0aD17cG9wb3Zlck1pbldpZHRofVxuICAgICAgICAgICAgICBwb3NpdGlvbj17XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gfHxcbiAgICAgICAgICAgICAgICAodGhpcy5zdGF0ZS50YXJnZXRXaWR0aCA8IHBvcG92ZXJNaW5XaWR0aFxuICAgICAgICAgICAgICAgICAgPyBQb3NpdGlvbi5CT1RUT01fTEVGVFxuICAgICAgICAgICAgICAgICAgOiBQb3NpdGlvbi5CT1RUT00pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgY29udGVudD17KCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlclJlc3VsdHMoe1xuICAgICAgICAgICAgICAgICAgd2lkdGg6IE1hdGgubWF4KHRoaXMuc3RhdGUudGFyZ2V0V2lkdGgsIHBvcG92ZXJNaW5XaWR0aCksXG4gICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlLFxuICAgICAgICAgICAgICAgICAgZ2V0SXRlbVByb3BzLFxuICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtLFxuICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICAgICAgICAgIHNlbGVjdEl0ZW1BdEluZGV4XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgbWluSGVpZ2h0PXswfVxuICAgICAgICAgICAgICBhbmltYXRpb25EdXJhdGlvbj17MH1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgeyh7IGlzU2hvd246IGlzU2hvd25Qb3BvdmVyLCB0b2dnbGUsIGdldFJlZiB9KSA9PlxuICAgICAgICAgICAgICAgIGNoaWxkcmVuKHtcbiAgICAgICAgICAgICAgICAgIGlzU2hvd246IGlzU2hvd25Qb3BvdmVyLFxuICAgICAgICAgICAgICAgICAgdG9nZ2xlLFxuICAgICAgICAgICAgICAgICAgZ2V0UmVmOiByZWYgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBVc2UgdGhlIHJlZiBpbnRlcm5hbGx5IHRvIGRldGVybWluZSB0aGUgd2lkdGhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXRSZWYgPSByZWZcbiAgICAgICAgICAgICAgICAgICAgZ2V0UmVmKHJlZilcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBpbnB1dFZhbHVlLFxuICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtLFxuICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRJbmRleCxcbiAgICAgICAgICAgICAgICAgIHNlbGVjdEl0ZW1BdEluZGV4LFxuICAgICAgICAgICAgICAgICAgLi4ucmVzdERvd25zaGlmdFByb3BzXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9Qb3BvdmVyPlxuICAgICAgICAgIDwvUGFuZT5cbiAgICAgICAgKX1cbiAgICAgIDwvRG93bnNoaWZ0PlxuICAgIClcbiAgfVxufVxuIl19